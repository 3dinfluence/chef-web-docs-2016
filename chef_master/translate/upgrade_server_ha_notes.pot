# SOME DESCRIPTIVE TITLE.
# Copyright (C) This work is licensed under a Creative Commons Attribution 3.0 Unported License.
# This file is distributed under the same license as the Chef Docs package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: Chef Docs \n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2014-10-14 14:12-0700\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: ../source/upgrade_server_ha_notes.rst:8
# af501c643e3e44218ae0c73765b60996
msgid "Notes for High Availability |chef server oec| Upgrades"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:10
# 4e77657adabf4d5098bee003392e3f69
msgid "The following sections contain notes about specific scenarios that some customers may run into when upgrading from |chef private| to |chef server oec|. Please consult with |company_name| support about any of these situations."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:13
# b34dad65776849d488d9d16945c5f4f1
msgid "All Upgrade Scenarios"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:15
# 76a4ee64c58645c1a9d8cb827af5aab6
msgid "All upgrades should be performed first with a copy of production data, but in an environment that is non-essential. This is often done using a |vagrant| virtual machine, but any non-essential environment suitable for testing the upgrade of production data is OK."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:17
# 424978f06009470ea6128c5361519f9d
msgid "Backups are good to have for many reasons, at all times. This is especially true during upgrades. Therefore, ensure that tested backups are available during the entire upgrade process."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:21
# 5b5edabac77548fe9e8ec0bd8b923a91
msgid "Upgrading from |chef private| 1.2.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:23
# b20b9d7f9ae448a783dddd80cfe50bfe
msgid "Upgrading from |chef private| 1.2.x to any version of |chef server oec| 11 **REQUIRES** that |chef private| 1.2.x first be upgraded (on all systems) to |chef private| 1.4.6+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:27
# b013a7723d054b6b96c6cdb524bd31e5
msgid "Upgrading from |chef private| 1.4.6+ to |chef server oec| 11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:29
# 746120f6f764492b995d5180ed505e92
msgid "The following sections are specific to |chef private| 1.4.6+ upgrades to |chef server oec| 11.1.3+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:31
# 3a749ff4e0eb4544b84392877d82e363
msgid "Unless otherwise noted, all patching should be done after |chef private| 1.4.6+ is installed, and before the |chef server oec| 11.1.3+ package install and upgrade begins."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:34
# 1d38711bdef34dfe89c06d97495b01d1
msgid "Known Issues"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:36
# 38ee75352e474cfa8a39ec3d4dcbe469
msgid "The following bugs may affect the upgrade:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:38
# 475735089a3e4881b7f62c71820d1548
msgid "As of |chef server oec| 11.1.8:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:40
# 5a1109cf369d4fa2b753c1504164151c
msgid "OC-11575 --- Services start automatically at boot on backup/passive machine in HA mode"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:41
# bfe877bd2699439a9796dfaeff5cae41
msgid "OC-11601 --- During an upgrade redis_lb isn't restarted before the attempt to reconfigure it."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:43
# 4e80e7b4ab2f4843a483833fcc9c1104
msgid "Before |chef server oec| 11.1.8:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:45
# fd3de850e76e4ba6b0da2d985e8b9cda
msgid "OC-11297 --- |chef server oec| 11.0.X not saving its migration-level state on HA back end machines. Breaks ``private-chef-ctl upgrade`` on subsequent upgrades"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:46
# 788b28cef58b4ea391abae8890f9ca9a
msgid "OC-11382 --- HA Upgrades to 11.1.3+ fail because keepalived restart interferes with partybus migrations"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:47
# a727285dbd0b4449a2548235566c3b4b
msgid "OC-11426 --- Upgrade Runit Ownership Issue OPC 1.4.6 -> EC11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:48
# f57b180c9ea6477ebacd7b9e44c8a99e
msgid "OC-11490 --- Root ownership of ``/var/log/opscode/keepalived`` prevents keepalived from running properly"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:49
# 9e286e29d3a34bd3a16a46933c3fd366
msgid "OC-11540 --- Setting non_ssl_port to false causes invalid opscode-account configuration"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:50
# 7b61fb6f120a4d9eb833963811e8d6ea
msgid "OC-11656 --- Test Umask Inheritance and Cleanup Ownership in EC11 Embedded Cookbooks"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:51
# 6e7dfcfba692436c98a61c3e449b48cb
msgid "OC-11657 --- Default svwait timeout of 7 seconds is too short, causes many unnecessary failures during reconfigure/upgrade scenarios"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:52
# b0b5cb73da2a4e1bbe4568ed150387b7
msgid "OC-11658 --- oc_authz_migrator failures are not trapped, leaving Authz -> Bifrost data un-migrated"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:53
# 401de8eca48e4f4cbeaa30c2adde3985
msgid "OC-11662 --- redis_lb timeout is too short for the real world"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:54
# 910fb9bc860049ff870cc19aa4599649
msgid "OC-11669 --- During 1.4.x -> EC 11.x upgrade on Ubuntu and EL6 systems, keepalived transitions to backup because of the opscode-runsvdir -> private-chef-runsvdir change"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:55
# 6477828109874f50af1b8a999035e490
msgid "OC-11670 --- Partybus migration step 1.9 silently fails to run if keepalived is still in transition"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:57
# 8f43775664c3474788b860fa7ec1658e
msgid "Check runsvdir status during the upgrade, especially between each upgrade of the system. Here is an example of the highest level upgrade process that should be followed: check runsvdir status -> |chef private| 1.2.x -> check runsvdir status -> |chef private| 1.4.6+ -> check runsvdir status -> |chef server oec| 11.1.3+ -> check runsvdir status. See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:61
# ef089c1872d7448b99ad50ee4381024f
msgid "Pre-Flight Check"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:62
# ad9c7c7d496d4b52b8124bba1ece38a4
msgid "It is recommended to do the following:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:64
# 52e89ee6bbbc4c6f8da925b1247a0d90
msgid "Backup the data on the bootstrap back end machine. (e.g. LVM snapshot, VMware snapshot, etc)"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:66
# d3c7340011264bbaacd71bf79705e7ed
msgid "Run the following command on all machines to make sure things are in a sane state. (e.g. runit):"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:72
# 4680e4cb70f8445086aa178fa7a10eae
msgid "Stop all frontend machines:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:78
# 242d4389809f448d8ddfe482dbe21a69
msgid "Identify the name of the original non-bootstrap back end machine. This is the back end machine that does not have ``:bootstrap => true`` in ``/etc/opscode/private-chef.rb``."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:80
# 7f8cb61349814b2a99d92603767962f9
msgid "Stop keepalived on the original non-bootstrap back end machine. This will ensure that the bootstrap back end machine is the active machine. This action may trigger a failover."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:86
# ec6e39ce4b2542a5b8bb410946eca92f
msgid "For known issue OC-11297 - On the back end machines, examine the ``/var/opt/opscode/upgrades/migration-level`` file. It should match the version on the front end machines. In high availability systems, the migration-level file is usually correct on the front end nodes but not the back end nodes due to the fact that the back end machine installation process gets interrupted for DRBD setup. If it is incorrect on the back end machines, please copy it from the front end nodes before proceeding."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:92
# e7cf3f1a76e54942a11a9a98143a1ec9
msgid "Chef Server Version"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:93
# 93aed976dd3644afbd51bb16fba056de
msgid "Migration Level"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:94
# ec53a849d660420a85bef8ef7bcaec3d
msgid "|chef private| 1.4.6+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:95
# f4096f38cb744764b398e79eb73c763c
msgid "major: 1, minor: 7"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:96
# b8af46ace3e8415a902d3e1d72c9c0bd
msgid "|chef server oec| 11.0.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:97
# f1c9b62c861040cba8d3d6f5358ad2e0
msgid "major: 1, minor: 12"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:98
# 40ca9ff643774874b3f57ac51cfefbf2
msgid "|chef server oec| 11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:99
# 27ddcb2838e84c65a6bad3a792397d75
msgid "major: 1, minor: 13"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:101
# 9c402cac710b44afbf4fcc3b15c62108
msgid "While running |chef private| 1.4.6+ and before the upgrade, be sure that the status for |runit| looks good. See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:103
# c710cd52e7b74eea8bccea06c3d31757
msgid "Before proceeding, make sure that the bootstrap back end machine and all of its services are healthy, and that all services are stopped on the standby. Please check runsvdir status to make a determination about \"healthy\". See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:107
# 26bd005289644404af7bfc1d683e4940
msgid "Upgrade Steps"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:109
# 71e4deb5d05141b2a803f309d474b605
msgid "Install the |chef server oec| server package on all machines using |debian dpkg| or rpm."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:111
# a92bdcca08564ec2873d20812dbba21d
msgid "On both backend nodes, apply the patches from the Patches section at the bottom of this page"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:113
# 665723be03864726b3f2a3eccbeaa492
msgid "On the bootstrap (primary) backend machine, perform a reconfigure and then WAIT about 2 minutes until all services have returned to a normal, working state according to ha-status and ``/var/log/opscode/keepalived/cluster.log``:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:119
# fc9822e83302440098f92034897fe9d7
msgid "In a separate terminal window run this to monitor cluster state:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:126
# eb5bdb25eafd4de2b6388b3fbe17fec3
msgid "During a 1.4.x to 11.x upgrade, the following services will remain down/unavailable and can be safely ignored. They will all be removed by ``private-chef-ctl cleanup`` except for ``opscode-chef-mover``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:128
# 4d514915033a42d797895bd03a418fea
msgid "fcgiwrap"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:129
# d96063f88ff94f5e887b7efb507fcc1a
msgid "nagios"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:130
# 248dba04fbab4fdf8eaecf3b9b2e9558
msgid "nrpe"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:131
# 00e7b38c256e46058be1c944603d36c9
msgid "opscode-chef"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:132
# 959f85b5f0b243f181baa94060166cfe
msgid "opscode-chef-mover"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:133
# 9d9fa45e1d044fa4b00f2e574729371c
msgid "php-fpm"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:134
# 454987b582774b9ba85d768df4be16a4
msgid "redis"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:136
# ae173cfee6c3486f8cd8bd73935362aa
msgid "Once all services are verified, upgrade the bootstrap back end machine. (If anything strange happens here, please consider how the issue you see you could be related to runit. Please check runsvdir status for cleanup. You will also need to ensure that all ``omnibus-ctl``, ``private-chef-ctl``, and ``sv`` processes are gone. Then, be sure that the ``opscode-chef-mover`` service is started and retry the upgrade.)"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:144
# 077728360f0e461caad3bb86a1d8400d
msgid "Copy the entire ``/etc/opscode`` directory from the bootstrap back end machine to all front end and back end machines. For example, from each machine run:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:150
# 06f16794ec974e30b592df904907ce5e
msgid "Upgrade the secondary back end machine."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:156
# f99224768459436da9c358271713222b
msgid "Upgrade all frontend machines."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:162
# 13872b0ca1eb443db0d17903165bcd06
msgid "Run the following on all machines to make sure all services are started."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:168
# 0fcccd91b8404ecaad9b0722d39e1b46
msgid "After the upgrade process is complete, and the state of the system after the upgrade has been tested and verified, remove old data on all machines."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:176
# 5fb8f2c4d4364545a6247a409bf549e2
msgid "Runit Process Structure and Checks"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:178
# 1090512a97b245838feb9c1ab1e82d3e
msgid "Please use the following diagram to understand the runit process supervision tree. All runit components can be inspected with ``ps aux | grep [s]v``::"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:188
# d03b7bc1f65845939b1240e3b001d81b
msgid "In the diagram above, the Upstart config file is located at ``/etc/init/opscode-runsvdir`` on pre-|chef server oec| 11, and at ``/etc/init/private-chef-runsvdir`` in |chef server oec| 11.1.3+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:190
# d4f85be465384a0a814f957baf75454c
msgid "Between upgrades from major version to major version of |chef private| or |chef server oec|, you will want to check that the ``ps aux | grep [r]unsvdir`` output looks similar to:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:199
# 39ec71e62c4940d68809029c9022c95b
msgid "and not similar to:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:209
# a4ecc5d326e24e96bda67e351c98b1bc
msgid "Any number of issues can occur with the runsvdir process in |runit|. The most common in an |chef private| or |chef server oec| setting are these:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:211
# 75be13aa4c3343e49a58c37960319c88
msgid "In |chef private| 1.4.6+, ``/var/log/opscode`` should have ``755`` permissions, but it doesn't"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:212
# fcabf307f8074595ad45aa962eb37301
msgid "Any of the ``/var/log/opscode/SERVICE/current`` files are missing"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:213
# 9dc09409c79e4b72a656826426da00f5
msgid "In |chef server oec|, the ownership of ``/var/log/opscode`` is not ``opscode``, so the processes cannot read/write their log files"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:214
# 2c2cdf0722994c9cb95e2da88b56aa25
msgid "The filesystem where the logs are stored is full"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:216
# 7904352ebfc6466e997140c7a72c6b8d
msgid "When this type of problem is encountered, the process is to check the error output in the process list as above, and figure out what has gone wrong for either the runsvdir, or its svlogd processes, or both. Correct the issue, shutdown |chef private| or |chef server oec|, then use |upstart| to restart runsvdir:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:222
# 77f7239bdd734a919c4c9db4c79005d6
msgid "Restart the runsvdir:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:224
# 0bdca8b4217945ec9d3c651687aad4a7
msgid "For |chef private| 1.4.6+ on RHEL6 and ubuntu10.04+ ``initctl stop opscode-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:225
# af5c077e718e499591f70678ad6ffd3e
msgid "For |chef server oec| 11.x on RHEL6 and ubuntu10.04+ ``initctl stop private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:227
# a6bcaae81c0d445a880df41daaff7d5d
msgid "During the upgrade of |chef private| 1.4.6+ -> |chef server oec| 11.1.3+, you may have both of the above."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:229
# 7766728c7c904bc2a299a8e48ad8663c
msgid "If continuing an |chef server oec| 11.1.3+ upgrade ``initctl start private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:230
# 258d962ff4ed459e80522d0b7c3ce56f
msgid "If fixing up an |chef private| 1.4.6+ system before an upgrade to |chef server oec| 11.1.3+ ``initctl start private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:233
# b6bf95e8758a47449478ef71b4eb59b6
msgid "Example"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:234
# c0f3a7d1596942c0a5428bcc7cb870bd
msgid "The following is one specific problem-fix scenario encountered while proceeding through an |chef private| 1.4.6+ -> |chef server oec| 11.1.3+ upgrade. The issue was likely triggered by an unhealthy |runit| status while running at version |chef private| 1.4.6+::"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:272
# da219bf5fe604dd49d86652ea2cc77e8
msgid "|chef server oec| Patches as of 11.1.8"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:275
# ecbfc6207e644fdaa9d940601fc3b5ac
msgid "OC-11575 patch for |chef server oec| 11.1.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:276
# a21a21721cab4c989f574e8350954017
msgid "Copy this file to ``/opt/opscode/embedded/cookbooks/enterprise/definitions/component_runit_service.rb`` on your backend nodes:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:337
# 7234b2bdae6c429f920f67c9ace829c7
msgid "OC-11601 patch for |chef server oec| 11.1.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:338
# 6e53d1b81c804200a939994a8002a17e
msgid "Copy this file to ``/opt/opscode/embedded/cookbooks/private-chef/recipes/redis_lb.rb`` on your backend nodes:"
msgstr ""

