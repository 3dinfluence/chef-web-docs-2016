# SOME DESCRIPTIVE TITLE.
# Copyright (C) This work is licensed under a Creative Commons Attribution 3.0 Unported License.
# This file is distributed under the same license as the Chef Docs package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: Chef Docs \n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2014-08-27 16:02-0700\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: ../source/upgrade_server_ha_notes.rst:8
# 8a36b1873c9344d385f0bcdae342e431
msgid "Notes for High Availability |chef server oec| Upgrades"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:10
# 0994046a3845400ea230dec283a717c6
msgid "The following sections contain notes about specific scenarios that some customers may run into when upgrading from |chef private| to |chef server oec|. Please consult with |company_name| support about any of these situations."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:13
# d100aa00e589432984612923fe5b7965
msgid "All Upgrade Scenarios"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:15
# c43c9dca64354952b9f5cd635c86676f
msgid "All upgrades should be performed first with a copy of production data, but in an environment that is non-essential. This is often done using a |vagrant| virtual machine, but any non-essential environment suitable for testing the upgrade of production data is OK."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:17
# 7f8977b67b0348938da5a66c8898bb9c
msgid "Backups are good to have for many reasons, at all times. This is especially true during upgrades. Therefore, ensure that tested backups are available during the entire upgrade process."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:21
# e170635f1e7d4d8cabcb0fc17bbad92b
msgid "Upgrading from |chef private| 1.2.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:23
# ced1f08f87a8421fbb892e898d800b78
msgid "Upgrading from |chef private| 1.2.x to any version of |chef server oec| 11 **REQUIRES** that |chef private| 1.2.x first be upgraded (on all systems) to |chef private| 1.4.6+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:27
# 7072ff638d294a479f658dfd2ab8c44c
msgid "Upgrading from |chef private| 1.4.6+ to |chef server oec| 11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:29
# dbad3e438fde48eabb8438c54a53c8ea
msgid "The following sections are specific to |chef private| 1.4.6+ upgrades to |chef server oec| 11.1.3+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:31
# 665b03c56aab46b2ac82f97052ef5674
msgid "Unless otherwise noted, all patching should be done after |chef private| 1.4.6+ is installed, and before the |chef server oec| 11.1.3+ package install and upgrade begins."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:34
# 8c44431400964b4e9d14815ecda99c93
msgid "Known Issues"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:36
# bc181854990b44ccab815219b24e8f7d
msgid "The following bugs may affect the upgrade:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:38
# 2bbcf4d4bd074ce294aaa828fbc75d7d
msgid "As of |chef server oec| 11.1.8:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:40
# d7153525f46a4547ba9946d9fa8c5c1b
msgid "OC-11575 --- Services start automatically at boot on backup/passive machine in HA mode"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:41
# 2c302c1c257f4c139b3f06e47a10ccc1
msgid "OC-11601 --- During an upgrade redis_lb isn't restarted before the attempt to reconfigure it."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:43
# 3bfa6c70e0a14e2a82a35b5ac1aba7f1
msgid "Before |chef server oec| 11.1.8:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:45
# 88b57e477be94922afa6934936777e76
msgid "OC-11297 --- |chef server oec| 11.0.X not saving its migration-level state on HA back end machines. Breaks ``private-chef-ctl upgrade`` on subsequent upgrades"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:46
# af4ddc8c4d4f4919ba84fa9e0c935421
msgid "OC-11382 --- HA Upgrades to 11.1.3+ fail because keepalived restart interferes with partybus migrations"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:47
# 2d7bcf17a9fe48418f2676024d39d9e7
msgid "OC-11426 --- Upgrade Runit Ownership Issue OPC 1.4.6 -> EC11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:48
# ad4687eb93d648af9cdfa678a62d15af
msgid "OC-11490 --- Root ownership of ``/var/log/opscode/keepalived`` prevents keepalived from running properly"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:49
# 0ed0f98460914a22af2d9cceb1f54c57
msgid "OC-11540 --- Setting non_ssl_port to false causes invalid opscode-account configuration"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:50
# 5f67b2206fe540ffa6da08e94f668e71
msgid "OC-11656 --- Test Umask Inheritance and Cleanup Ownership in EC11 Embedded Cookbooks"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:51
# 903b288c024c4dfc8dc655839b79799b
msgid "OC-11657 --- Default svwait timeout of 7 seconds is too short, causes many unnecessary failures during reconfigure/upgrade scenarios"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:52
# 6257ee284f8348b89f6ddb8ade74aed0
msgid "OC-11658 --- oc_authz_migrator failures are not trapped, leaving Authz -> Bifrost data un-migrated"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:53
# 1c54c62a2f994066babcdb83b34828f5
msgid "OC-11662 --- redis_lb timeout is too short for the real world"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:54
# 7b0a90a0585745c184ab6051d3c35c70
msgid "OC-11669 --- During 1.4.x -> EC 11.x upgrade on Ubuntu and EL6 systems, keepalived transitions to backup because of the opscode-runsvdir -> private-chef-runsvdir change"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:55
# 602edebd4a504e81bd673c594bdb99dc
msgid "OC-11670 --- Partybus migration step 1.9 silently fails to run if keepalived is still in transition"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:57
# 9f7d6374fb9c44989d9a17edb261b895
msgid "Check runsvdir status during the upgrade, especially between each upgrade of the system. Here is an example of the highest level upgrade process that should be followed: check runsvdir status -> |chef private| 1.2.x -> check runsvdir status -> |chef private| 1.4.6+ -> check runsvdir status -> |chef server oec| 11.1.3+ -> check runsvdir status. See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:61
# 207bab6cc1ce4b16accb6f8e4bffb8d8
msgid "Pre-Flight Check"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:62
# a5fda5d2365f43be8460d53c06101727
msgid "It is recommended to do the following:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:64
# 703faa3617914cf5ae678fb58ad53ba1
msgid "Backup the data on the bootstrap back end machine. (e.g. LVM snapshot, VMware snapshot, etc)"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:66
# 4682950f8848430d8fbeaf044af9bb4c
msgid "Run the following on all machines to make sure things are in a sane state. (e.g. runit):"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:72
# 443f7096815f403c985cfc9ad319f880
msgid "Stop all frontend machines:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:78
# ea51474d6ed84cb28b72e6340c2899c1
msgid "Identify the name of the original non-bootstrap back end machine. This is the back end machine that does not have ``:bootstrap => true`` in ``/etc/opscode/private-chef.rb``."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:80
# fd87cf440b0f4276a06846666fd8fc97
msgid "Stop keepalived on the original non-bootstrap back end machine. This will ensure that the bootstrap back end machine is the active machine. This action may trigger a failover."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:86
# af0f06230ebf4b9bb2506b7a63c46924
msgid "For known issue OC-11297 - On the back end machines, examine the ``/var/opt/opscode/upgrades/migration-level`` file. It should match the version on the front end machines. In high availability systems, the migration-level file is usually correct on the front end nodes but not the back end nodes due to the fact that the back end machine installation process gets interrupted for DRBD setup. If it is incorrect on the back end machines, please copy it from the front end nodes before proceeding."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:92
# 8bbf4428cba242e69819a6467605161d
msgid "Chef Server Version"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:93
# 61c519fdde2341e0a8320a82617b40ae
msgid "Migration Level"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:94
# af9dd3cb9fd8487a87617497fe78adc9
msgid "|chef private| 1.4.6+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:95
# f25ae137b9ab4d86bd05a448e5a1b7ea
msgid "major: 1, minor: 7"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:96
# d273bc465e1a42d99adc0c9f00f715a9
msgid "|chef server oec| 11.0.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:97
# db407480d4924e4b9689c2e15bb6472a
msgid "major: 1, minor: 12"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:98
# 3ee3d80f28ec42279bab04740160b178
msgid "|chef server oec| 11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:99
# 79ad4cbc8b7a49ca976d79a374a91736
msgid "major: 1, minor: 13"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:101
# 5e050420dfc24fc99745b42c05ffb826
msgid "While running |chef private| 1.4.6+ and before the upgrade, be sure that the status for |runit| looks good. See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:103
# ee8a19b129ab40a0ad00785dd43708d3
msgid "Before proceeding, make sure that the bootstrap back end machine and all of its services are healthy, and that all services are stopped on the standby. Please check runsvdir status to make a determination about \"healthy\". See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:107
# 03946fae0f9b44069ee1950b2a78d2d5
msgid "Upgrade Steps"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:109
# b4a1a6822b194881b2f65ba943a15fc2
msgid "Install the |chef server oec| server package on all machines using |debian dpkg| or rpm."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:111
# 157d3a6c068a4ec0a818555a1dc40c52
msgid "On both backend nodes, apply the patches from the Patches section at the bottom of this page"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:113
# 2419e730ef15465d98ddcb928805c4c5
msgid "On the bootstrap (primary) backend machine, perform a reconfigure and then WAIT about 2 minutes until all services have returned to a normal, working state according to ha-status and ``/var/log/opscode/keepalived/cluster.log``:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:119
# dcea90a6796d4379b1004f4d651cc43c
msgid "In a separate terminal window run this to monitor cluster state:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:126
# 109bc7449ea44a039c3d50ba5a88514d
msgid "During a 1.4.x to 11.x upgrade, the following services will remain down/unavailable and can be safely ignored. They will all be removed by ``private-chef-ctl cleanup`` except for ``opscode-chef-mover``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:128
# e146ce8e2b6345ddaba2af1020bfdfa2
msgid "fcgiwrap"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:129
# 338e3ed577c145c28214467e51bdc61d
msgid "nagios"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:130
# d62cd91c03284e379700ba3edc950075
msgid "nrpe"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:131
# 2ad54983a7674da1ac2961224e567cf0
msgid "opscode-chef"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:132
# ff99932b004e4e48b3ea6f81d9ebba0c
msgid "opscode-chef-mover"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:133
# fbdf15cd2c8044a8b8cb635e9b0f9b7d
msgid "php-fpm"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:134
# fa9cc4fd508d44b79bff92710a0f92c9
msgid "redis"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:136
# a76b142b41984c2abd849d514caea5e9
msgid "Once all services are verified, upgrade the bootstrap back end machine. (If anything strange happens here, please consider how the issue you see you could be related to runit. Please check runsvdir status for cleanup. You will also need to ensure that all ``omnibus-ctl``, ``private-chef-ctl``, and ``sv`` processes are gone. Then, be sure that the ``opscode-chef-mover`` service is started and retry the upgrade.)"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:144
# 7a3a5ef63e0e4c6a9329cdcabf56e2d1
msgid "Copy the entire ``/etc/opscode`` directory from the bootstrap back end machine to all front end and back end machines. For example, from each machine run:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:150
# 10cf223e66444adb96c48995065daa0f
msgid "Upgrade the secondary back end machine."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:156
# 967e1a8d5aca4b14bdfd33f1a088fd39
msgid "Upgrade all frontend machines."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:162
# 0afc15d88f31416fabd54058d099c8c3
msgid "Run the following on all machines to make sure all services are started."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:168
# 2f5b3d0138404dc2b63f41cf0de361da
msgid "After the upgrade process is complete, and the state of the system after the upgrade has been tested and verified, remove old data on all machines."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:176
# 2ea1a01182544619bd44ef2c292c476e
msgid "Runit Process Structure and Checks"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:178
# 658d8666c8354d6b87061c8d816b9554
msgid "Please use the following diagram to understand the runit process supervision tree. All runit components can be inspected with ``ps aux | grep [s]v``::"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:188
# d13a5b756859479c9209547136683755
msgid "In the diagram above, the Upstart config file is located at ``/etc/init/opscode-runsvdir`` on pre-|chef server oec| 11, and at ``/etc/init/private-chef-runsvdir`` in |chef server oec| 11.1.3+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:190
# b9fad34ac9b449ac98cef89c990bf313
msgid "Between upgrades from major version to major version of |chef private| or |chef server oec|, you will want to check that the ``ps aux | grep [r]unsvdir`` output looks similar to:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:199
# 59182a1af55245518b925d23fb0caee4
msgid "and not similar to:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:209
# 0b347218cf72432da0d9ad6ed910adf7
msgid "Any number of issues can occur with the runsvdir process in |runit|. The most common in an |chef private| or |chef server oec| setting are these:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:211
# 486f833850d04e6e873ff25cce59c723
msgid "In |chef private| 1.4.6+, ``/var/log/opscode`` should have ``755`` permissions, but it doesn't"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:212
# f2086ac744d749ac9b25261e934821da
msgid "Any of the ``/var/log/opscode/SERVICE/current`` files are missing"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:213
# 25ce6d3b088245ab93f6d56774e30969
msgid "In |chef server oec|, the ownership of ``/var/log/opscode`` is not ``opscode``, so the processes cannot read/write their log files"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:214
# a01a0584c59a42f298e3c6300f2ceb07
msgid "The filesystem where the logs are stored is full"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:216
# b0ecf1e259f646059eedbbbcce6050e6
msgid "When this type of problem is encountered, the process is to check the error output in the process list as above, and figure out what has gone wrong for either the runsvdir, or its svlogd processes, or both. Correct the issue, shutdown |chef private| or |chef server oec|, then use |upstart| to restart runsvdir:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:222
# a2ed544c39d54c219e9292303a43bacf
msgid "Restart the runsvdir:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:224
# 198c562e5f234138a91334c8589ddbfb
msgid "For |chef private| 1.4.6+ on RHEL6 and ubuntu10.04+ ``initctl stop opscode-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:225
# a10b8d76da9f400685a392a802122859
msgid "For |chef server oec| 11.x on RHEL6 and ubuntu10.04+ ``initctl stop private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:227
# e814b951fa834b638aa19eb6320875f5
msgid "During the upgrade of |chef private| 1.4.6+ -> |chef server oec| 11.1.3+, you may have both of the above."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:229
# 3671c9beabd547bebc920ecb7f819a26
msgid "If continuing an |chef server oec| 11.1.3+ upgrade ``initctl start private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:230
# 156079470fe7436284b7b4d3dce70bfe
msgid "If fixing up an |chef private| 1.4.6+ system before an upgrade to |chef server oec| 11.1.3+ ``initctl start private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:233
# 37f926f47fc64702a66d23b3dc11443e
msgid "Example"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:234
# 58a58b7a37e34bc49c3a8a8dd530e655
msgid "The following is one specific problem-fix scenario encountered while proceeding through an |chef private| 1.4.6+ -> |chef server oec| 11.1.3+ upgrade. The issue was likely triggered by an unhealthy |runit| status while running at version |chef private| 1.4.6+::"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:272
# 60315bd417a949e987c3bed16ca2c0d6
msgid "|chef server oec| Patches as of 11.1.8"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:275
# 23ebc148953c4b23839d2c7867c6b7d0
msgid "OC-11575 patch for |chef server oec| 11.1.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:276
# cc77bf08159341b9a78dac81ad2bc6b3
msgid "Copy this file to ``/opt/opscode/embedded/cookbooks/enterprise/definitions/component_runit_service.rb`` on your backend nodes:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:337
# 420566a15ee042ca92e5da36f56ef804
msgid "OC-11601 patch for |chef server oec| 11.1.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:338
# 6553bf996a7940e1a967df9192fd69cd
msgid "Copy this file to ``/opt/opscode/embedded/cookbooks/private-chef/recipes/redis_lb.rb`` on your backend nodes:"
msgstr ""

