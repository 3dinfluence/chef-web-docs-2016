# SOME DESCRIPTIVE TITLE.
# Copyright (C) This work is licensed under a Creative Commons Attribution 3.0 Unported License.
# This file is distributed under the same license as the Chef Docs package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: Chef Docs \n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2014-10-29 11:08-0700\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: ../source/upgrade_server_ha_notes.rst:8
# ba8f460a088d48a1b6ec4b0c6590dc1c
msgid "Notes for High Availability |chef server oec| Upgrades"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:10
# fb518453ca1642de84f8405fff0499c7
msgid "The following sections contain notes about specific scenarios that some customers may run into when upgrading from |chef private| to |chef server oec|. Please consult with |company_name| support about any of these situations."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:13
# 18e1a28b63f34f45b35649f9383df61a
msgid "All Upgrade Scenarios"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:15
# ae871fe3c78a461d98d46b7a937ca9ee
msgid "All upgrades should be performed first with a copy of production data, but in an environment that is non-essential. This is often done using a |vagrant| virtual machine, but any non-essential environment suitable for testing the upgrade of production data is OK."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:17
# f8fa3fd052f844c790de897338262172
msgid "Backups are good to have for many reasons, at all times. This is especially true during upgrades. Therefore, ensure that tested backups are available during the entire upgrade process."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:21
# aa000f969e52487bb0303002b1e6c24b
msgid "Upgrading from |chef private| 1.2.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:23
# 41723ae6655f405a8ddc9c40223611df
msgid "Upgrading from |chef private| 1.2.x to any version of |chef server oec| 11 **REQUIRES** that |chef private| 1.2.x first be upgraded (on all systems) to |chef private| 1.4.6+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:27
# fc4110c51a734e6a92f2d6a129e6734e
msgid "Upgrading from |chef private| 1.4.6+ to |chef server oec| 11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:29
# aaf4465734eb47e6860abd0396d447af
msgid "The following sections are specific to |chef private| 1.4.6+ upgrades to |chef server oec| 11.1.3+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:31
# c8d5d98654854948bf36f0aa2eef82c4
msgid "Unless otherwise noted, all patching should be done after |chef private| 1.4.6+ is installed, and before the |chef server oec| 11.1.3+ package install and upgrade begins."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:34
# 659455a7f3144c0085d8435d413e41a6
msgid "Known Issues"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:36
# 75698e4b179c45458fe1f6b10e721cd3
msgid "The following bugs may affect the upgrade:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:38
# ff746f0ec727443eaf07bd1956dd542b
msgid "As of |chef server oec| 11.1.8:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:40
# 72921c997a9b4511acd553558806fba6
msgid "OC-11575 --- Services start automatically at boot on backup/passive machine in HA mode"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:41
# 8fe6edca360a400bb1884f15aacacab8
msgid "OC-11601 --- During an upgrade redis_lb isn't restarted before the attempt to reconfigure it."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:43
# 17b8c1bad5084ecf9ce46eef10892f97
msgid "Before |chef server oec| 11.1.8:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:45
# 5dc1c0f25abb439f9248cc624e1ed7d6
msgid "OC-11297 --- |chef server oec| 11.0.X not saving its migration-level state on HA back end machines. Breaks ``private-chef-ctl upgrade`` on subsequent upgrades"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:46
# 47c06b6897434dc281a83aafd949729a
msgid "OC-11382 --- HA Upgrades to 11.1.3+ fail because keepalived restart interferes with partybus migrations"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:47
# 6d38c4c7f19e48e2b2d1eec4fe4d25f0
msgid "OC-11426 --- Upgrade Runit Ownership Issue OPC 1.4.6 -> EC11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:48
# 05f15e77dd48407d88b32ddb5d3427fa
msgid "OC-11490 --- Root ownership of ``/var/log/opscode/keepalived`` prevents keepalived from running properly"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:49
# db504dbf87924a129908fb8ef98021e5
msgid "OC-11540 --- Setting non_ssl_port to false causes invalid opscode-account configuration"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:50
# 67c9e11b705a4a4b8283b970bb920525
msgid "OC-11656 --- Test Umask Inheritance and Cleanup Ownership in EC11 Embedded Cookbooks"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:51
# f34203d6f075497b87ef2d8b492e1fcc
msgid "OC-11657 --- Default svwait timeout of 7 seconds is too short, causes many unnecessary failures during reconfigure/upgrade scenarios"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:52
# ea6b1bc33e8e482d8be73fa047b93aac
msgid "OC-11658 --- oc_authz_migrator failures are not trapped, leaving Authz -> Bifrost data un-migrated"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:53
# 76e393a9973d47ada3d40ee0a477e74b
msgid "OC-11662 --- redis_lb timeout is too short for the real world"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:54
# ad8a988243254285b6ace5b7d6a87732
msgid "OC-11669 --- During 1.4.x -> EC 11.x upgrade on Ubuntu and EL6 systems, keepalived transitions to backup because of the opscode-runsvdir -> private-chef-runsvdir change"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:55
# 2f0edde8031949bf9141589056a95130
msgid "OC-11670 --- Partybus migration step 1.9 silently fails to run if keepalived is still in transition"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:57
# b5ce9559b1b748cd8e18cf8580c31c0e
msgid "Check runsvdir status during the upgrade, especially between each upgrade of the system. Here is an example of the highest level upgrade process that should be followed: check runsvdir status -> |chef private| 1.2.x -> check runsvdir status -> |chef private| 1.4.6+ -> check runsvdir status -> |chef server oec| 11.1.3+ -> check runsvdir status. See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:61
# c97e807c44af4714bf9ff31179fe8b35
msgid "Pre-Flight Check"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:62
# 4eb2a1a4287649d0a8222ffdd93ab4e9
msgid "It is recommended to do the following:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:64
# 720e45e7e9f54ae0b274436372046c26
msgid "Backup the data on the bootstrap back end machine. (e.g. LVM snapshot, VMware snapshot, etc)"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:66
# 646d954e7f2349d6be27ac716308f4b8
msgid "Run the following command on all machines to make sure things are in a sane state. (e.g. runit):"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:72
# 1f8ee10d8d9a4ae7b67b75d854c1524c
msgid "Stop all frontend machines:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:78
# 261b821b5a1b48e98eb4a65f61f0b342
msgid "Identify the name of the original non-bootstrap back end machine. This is the back end machine that does not have ``:bootstrap => true`` in ``/etc/opscode/private-chef.rb``."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:80
# b563637e237b4550a886e459ef8b4d91
msgid "Stop keepalived on the original non-bootstrap back end machine. This will ensure that the bootstrap back end machine is the active machine. This action may trigger a failover."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:86
# 55ac28a7912f4fa3a170480efb533837
msgid "For known issue OC-11297 - On the back end machines, examine the ``/var/opt/opscode/upgrades/migration-level`` file. It should match the version on the front end machines. In high availability systems, the migration-level file is usually correct on the front end nodes but not the back end nodes due to the fact that the back end machine installation process gets interrupted for DRBD setup. If it is incorrect on the back end machines, please copy it from the front end nodes before proceeding."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:92
# 1bf5dff66a6640a895c9f593c5d831ec
msgid "Chef Server Version"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:93
# a0c85269e5014143827172f649b503bc
msgid "Migration Level"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:94
# b6256c18075e472c8c213fdb1eefc21a
msgid "|chef private| 1.4.6+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:95
# dc3af0c1d04142f4ba6f0c4efb0ff328
msgid "major: 1, minor: 7"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:96
# f2fedf5409ad4dd097d8aec090df6674
msgid "|chef server oec| 11.0.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:97
# 4f390641fef944a5ad0aa738e753a867
msgid "major: 1, minor: 12"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:98
# 4f736155b5114c06831b8d8b88f280cd
msgid "|chef server oec| 11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:99
# 74d7c0e5365c44799155c4f629b16edf
msgid "major: 1, minor: 13"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:101
# 7cf26945b7ef4c7d8c33896fa8171185
msgid "While running |chef private| 1.4.6+ and before the upgrade, be sure that the status for |runit| looks good. See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:103
# b6b96cd9dbbc44f6804b3c3210e2102b
msgid "Before proceeding, make sure that the bootstrap back end machine and all of its services are healthy, and that all services are stopped on the standby. Please check runsvdir status to make a determination about \"healthy\". See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:107
# fe55e112e6914392ace598754acb9f50
msgid "Upgrade Steps"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:109
# 5c0796ce3b5547aaa737b930826425a9
msgid "Install the |chef server oec| server package on all machines using |debian dpkg| or rpm."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:111
# 648f58958e7f45f09dff58f00ce60b78
msgid "On both backend nodes, apply the patches from the Patches section at the bottom of this page"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:113
# 63f0d487e4104723aff0012121251ce1
msgid "On the bootstrap (primary) backend machine, perform a reconfigure and then WAIT about 2 minutes until all services have returned to a normal, working state according to ha-status and ``/var/log/opscode/keepalived/cluster.log``:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:119
# 94c91af1e2124d4890360294545becf1
msgid "In a separate terminal window run this to monitor cluster state:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:126
# ca1672aeb52a4dd9a9873daafeac76b4
msgid "During a 1.4.x to 11.x upgrade, the following services will remain down/unavailable and can be safely ignored. They will all be removed by ``private-chef-ctl cleanup`` except for ``opscode-chef-mover``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:128
# f03a6a92d4b947dd80e3db3522c6ba3b
msgid "fcgiwrap"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:129
# 86dd3033fe884796a34c91912422a7d8
msgid "nagios"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:130
# 9c118f8a12d14edf9c30a53d7e2e8db3
msgid "nrpe"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:131
# 09edcc0c109b408e865a9727c6619c69
msgid "opscode-chef"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:132
# 089559620a9b4166ae9fade1717fd6c8
msgid "opscode-chef-mover"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:133
# c394e1c073ce4bb2858d35223f83fd09
msgid "php-fpm"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:134
# 209c2461664e4fe0bde12b07de2f7860
msgid "redis"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:136
# ba03bcc6514c4a27bab9c0b0726552d9
msgid "Once all services are verified, upgrade the bootstrap back end machine. (If anything strange happens here, please consider how the issue you see you could be related to runit. Please check runsvdir status for cleanup. You will also need to ensure that all ``omnibus-ctl``, ``private-chef-ctl``, and ``sv`` processes are gone. Then, be sure that the ``opscode-chef-mover`` service is started and retry the upgrade.)"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:144
# b425ff9c1f9e41d18e02454ccd296d11
msgid "Copy the entire ``/etc/opscode`` directory from the bootstrap back end machine to all front end and back end machines. For example, from each machine run:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:150
# 8e2b237bf88a4edd8a01da2d800b464d
msgid "Upgrade the secondary back end machine."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:156
# b7336992abf44626b9bdfdebc7cd9332
msgid "Upgrade all frontend machines."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:162
# cd61e9e8580c41abb3cd99254ac6df69
msgid "Run the following on all machines to make sure all services are started."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:168
# b00f0ef94e314b8e9091d2eb20e63fb7
msgid "After the upgrade process is complete, and the state of the system after the upgrade has been tested and verified, remove old data on all machines."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:176
# c4a53bbf36c1411badfe9c1474aebadb
msgid "Runit Process Structure and Checks"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:178
# 3036f5ec88ee4afea7d914cef35ff431
msgid "Please use the following diagram to understand the runit process supervision tree. All runit components can be inspected with ``ps aux | grep [s]v``::"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:188
# 0cfd259390d44d34bb0b944a69f2ed75
msgid "In the diagram above, the Upstart config file is located at ``/etc/init/opscode-runsvdir`` on pre-|chef server oec| 11, and at ``/etc/init/private-chef-runsvdir`` in |chef server oec| 11.1.3+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:190
# e8099fbc95cf4d14bf8fee83dd14de6d
msgid "Between upgrades from major version to major version of |chef private| or |chef server oec|, you will want to check that the ``ps aux | grep [r]unsvdir`` output looks similar to:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:199
# 37d543361aaf431c80de9c01c22af6bd
msgid "and not similar to:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:209
# 486a175f81d84864bf18c76200beee11
msgid "Any number of issues can occur with the runsvdir process in |runit|. The most common in an |chef private| or |chef server oec| setting are these:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:211
# bf4ea1691cbe4c6f9176f97601843d21
msgid "In |chef private| 1.4.6+, ``/var/log/opscode`` should have ``755`` permissions, but it doesn't"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:212
# 65332dcfb3e34e119c2bcb169d0db8ad
msgid "Any of the ``/var/log/opscode/SERVICE/current`` files are missing"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:213
# e023479b348a4c109b51bda24d7f3795
msgid "In |chef server oec|, the ownership of ``/var/log/opscode`` is not ``opscode``, so the processes cannot read/write their log files"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:214
# 3860017ca4b245e39f6e0b8070aace93
msgid "The filesystem where the logs are stored is full"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:216
# 881974c2e74342bb9454a3d9412191cc
msgid "When this type of problem is encountered, the process is to check the error output in the process list as above, and figure out what has gone wrong for either the runsvdir, or its svlogd processes, or both. Correct the issue, shutdown |chef private| or |chef server oec|, then use |upstart| to restart runsvdir:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:222
# d7f8335da22048d8a38d9f20a099bdd2
msgid "Restart the runsvdir:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:224
# 74d71aa67f234507be7a3b1f1771f381
msgid "For |chef private| 1.4.6+ on RHEL6 and ubuntu10.04+ ``initctl stop opscode-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:225
# 14b8b6b597ac42d3ad1d47961a270fff
msgid "For |chef server oec| 11.x on RHEL6 and ubuntu10.04+ ``initctl stop private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:227
# 699d1e6ff0984f9893623c5130359b82
msgid "During the upgrade of |chef private| 1.4.6+ -> |chef server oec| 11.1.3+, you may have both of the above."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:229
# 31fef72acfe1421e9a134107c26df606
msgid "If continuing an |chef server oec| 11.1.3+ upgrade ``initctl start private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:230
# 24981acfd31a469ba7c7eb2097999e3a
msgid "If fixing up an |chef private| 1.4.6+ system before an upgrade to |chef server oec| 11.1.3+ ``initctl start private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:233
# 9ad60a25a7804918965994ddb133ab02
msgid "Example"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:234
# 743b01290d4d4df389660ab8dbc43dff
msgid "The following is one specific problem-fix scenario encountered while proceeding through an |chef private| 1.4.6+ -> |chef server oec| 11.1.3+ upgrade. The issue was likely triggered by an unhealthy |runit| status while running at version |chef private| 1.4.6+::"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:272
# e18a50f3766b4c14bfb7c56bfa9bb4a2
msgid "|chef server oec| Patches as of 11.1.8"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:275
# d3183ca7bbc84bb9b316cd6d1c829c5f
msgid "OC-11575 patch for |chef server oec| 11.1.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:276
# 60caf9a8d8b94b129407d4afb64195fc
msgid "Copy this file to ``/opt/opscode/embedded/cookbooks/enterprise/definitions/component_runit_service.rb`` on your backend nodes:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:337
# 99238e393d64474eb510148349bffc2f
msgid "OC-11601 patch for |chef server oec| 11.1.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:338
# 7a3b0bd492a049888a8479c127de1a11
msgid "Copy this file to ``/opt/opscode/embedded/cookbooks/private-chef/recipes/redis_lb.rb`` on your backend nodes:"
msgstr ""

