# SOME DESCRIPTIVE TITLE.
# Copyright (C) This work is licensed under a Creative Commons Attribution 3.0 Unported License.
# This file is distributed under the same license as the Chef Docs package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: Chef Docs \n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2014-04-28 14:53-0700\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: ../source/upgrade_server_ha_notes.rst:8
# 3ee0d2d019ae41ae918e294c9326ef44
msgid "Notes for High Availability |chef server oec| Upgrades"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:10
# bfbe53c8ebd14da79ad66f8bc9c31d2d
msgid "The following sections contain notes about specific scenarios that some customers may run into when upgrading from |chef private| to |chef server oec|. Please consult with |company_name| support about any of these situations."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:13
# 12d88b19da4d4c48bb3309dbcf328b4e
msgid "All Upgrade Scenarios"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:15
# 9d008e41346448ce9876943e944f4098
msgid "All upgrades should be performed first with a copy of production data, but in an environment that is non-essential. This is often done using a |vagrant| virtual machine, but any non-essential environment suitable for testing the upgrade of production data is OK."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:17
# b9befad69248492aaebe63c86a7d7402
msgid "Backups are good to have for many reasons, at all times. This is especially true during upgrades. Therefore, ensure that tested backups are available during the entire upgrade process."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:21
# 6a8c65e2ff5b4effa42558cb4c1ef5ed
msgid "Upgrading from |chef private| 1.2.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:23
# 28bac662bca84d4e86001aa03605a74c
msgid "Upgrading from |chef private| 1.2.x to any version of |chef server oec| 11 **REQUIRES** that |chef private| 1.2.x first be upgraded (on all systems) to |chef private| 1.4.6+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:27
# 20fdf0935d9d415196974041b9774cce
msgid "Upgrading from |chef private| 1.4.6+ to |chef server oec| 11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:29
# 969483df4d93413681908a7bbaef7bd9
msgid "The following sections are specific to |chef private| 1.4.6+ upgrades to |chef server oec| 11.1.3+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:31
# 3461fa21f02144809654d20db55c8c37
msgid "Unless otherwise noted, all patching should be done after |chef private| 1.4.6+ is installed, and before the |chef server oec| 11.1.3+ package install and upgrade begins."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:34
# 8a964e0572cf4ceb82ae63322ec2c720
msgid "Known Issues"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:36
# b382d62347114a76a23aa895326c93c2
msgid "The following bugs may affect the upgrade:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:38
# 3290b0bb6ee54dbf9e353d871b210c5f
msgid "OC-11297 --- |chef server oec| 11.0.X not saving its migration-level state on HA back end machines. Breaks ``private-chef-ctl upgrade`` on subsequent upgrades"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:39
# 4133b364520042d8b82a5ce4fd011b1e
msgid "OC-11382 --- HA Upgrades to 11.1.3+ fail because keepalived restart interferes with partybus migrations"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:40
# 4785fa5d21be40f0932ebd257e17487e
msgid "OC-11490 --- Root ownership of ``/var/log/opscode/keepalived`` prevents keepalived from running properly"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:41
# 7a4662b7b74f4643861f6aa7290edf37
msgid "OC-11426 --- Upgrade Runit Ownership Issue OPC 1.4.6 -> EC11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:43
# bada81dfc5024f51a82e306142886495
msgid "Check runsvdir status during the upgrade, especially between each upgrade of the system. Here is an example of the highest level upgrade process that should be followed: check runsvdir status -> |chef private| 1.2.x -> check runsvdir status -> |chef private| 1.4.6+ -> check runsvdir status -> |chef server oec| 11.1.3+ -> check runsvdir status. See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:47
# e170e581bc3c4ec58bf6445ceccfb606
msgid "Pre-Flight Check"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:48
# d0884880e98c4ad9a47e60d8ef0e0a98
msgid "It is recommended to do the following:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:50
# 8ec00a9024ee4e06b3d9774b3a739b4d
msgid "Backup the data on the bootstrap back end machine. (e.g. LVM snapshot, VMware snapshot, etc)"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:52
# 7767b83b1be14bb9bffcc5c14cfc92f9
msgid "Run the following on all machines to make sure things are in a sane state. (e.g. runit):"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:58
# 0aed613579d746f588af57c0719e8fbc
msgid "Stop all frontend machines:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:64
# 3f8ed5b0882a4be19b70f9d740fa2a09
msgid "Identify the name of the original non-bootstrap back end machine. This is the back end machine that does not have ``:bootstrap => true`` in ``/etc/opscode/private-chef.rb``."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:66
# b0eee3d4ecea4b5791992065a3a2bcb4
msgid "Stop keepalived on the original non-bootstrap back end machine. This will ensure that the bootstrap back end machine is the active machine. This action may trigger a failover."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:72
# 1ddeb59a0ced41d9a137ce7bcfc9c9a3
msgid "For known issue OC-11297 - On the back end machines, examine the ``/var/opt/opscode/upgrades/migration-level`` file. It should match the version on the front end machines. In high availability systems, the migration-level file is usually correct on the front end nodes but not the back end nodes due to the fact that the back end machine installation process gets interrupted for DRBD setup. If it is incorrect on the back end machines, please copy it from the front end nodes before proceeding."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:78
# 64b5feefe6c54345a963a352374308d6
msgid "Chef Server Version"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:79
# dd269c484f49423e8e5e2cee8db9bb95
msgid "Migration Level"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:80
# f8f809d498684586945d1b54f8d02ecf
msgid "|chef private| 1.4.6+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:81
# 794269d8027a43d88fd03e3de426086f
msgid "major: 1, minor: 7"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:82
# 33d2eca1b7ee467c9c80e632f4790c1a
msgid "|chef server oec| 11.0.x"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:83
# 0879d8fb957d47e5b7b00deaffbbf3ba
msgid "major: 1, minor: 12"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:84
# 2ed5b9754d54436a836911a7fb62eac9
msgid "|chef server oec| 11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:85
# 6f5509c81e29493d93c2807606252c09
msgid "major: 1, minor: 13"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:87
# b76374f36af64971ab96c45cc14bab8a
msgid "For known issue OC-11490 - After installing the |chef server oec| 11.1.3+ package and before a reconfigure or upgrade, please apply the ``OC-11490.patch`` file listed below using the following commands as root. Please change the DIRECTORY as desired."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:96
# 0bb1ce7393e64fe98a2df949c4c68f7b
msgid "For known issue OC-11426 - While running |chef private| 1.4.6+ and before the upgrade, be sure that the status for |runit| looks good. See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:98
# b78df2a9d670449aae255d761ad346b2
msgid "Before proceeding, make sure that the bootstrap back end machine and all of its services are healthy, and that all services are stopped on the standby. Please check runsvdir status to make a determination about \"healthy\". See \"Runit Process Structure and Checks\" below for more information."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:102
# bf2fa90f491e42b78dcbe5a8bab3b574
msgid "Upgrade Steps"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:104
# 94e71006dd6e4c9792955d9980686e08
msgid "Install the |chef server oec| server package on all machines using |debian dpkg| or rpm."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:106
# 821b0620fbba496db915db8e1cc54083
msgid "OC-11382 - On both back end machines, copy the ``upgrade.rb`` file from the end of these notes to ``/opt/opscode/embedded/service/omnibus-ctl/upgrade.rb``."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:112
# f37c689448dd493c923da8337d584096
msgid "On the bootstrap back end machine, perform a reconfigure and then WAIT about 2 minutes until all services have returned to a normal, working state according to ha-status and ``/var/log/opscode/keepalived/cluster.log``:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:118
# 50207ed40d8d469cb44f2b5625b1fbcb
msgid "Once all services are verified, upgrade the bootstrap back end machine. (If anything strange happens here, please consider how the issue you see you could be related to runit. Please check runsvdir status for cleanup. You will also need to ensure that all ``omnibus-ctl``, ``private-chef-ctl``, and ``sv`` processes are gone. Then, be sure that the ``opscode-chef-mover`` service is started and retry the upgrade.)"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:126
# b6fcb6f6c9a443a599f5118422bb852c
msgid "Copy the entire ``/etc/opscode`` directory from the bootstrap back end machine to all front end and back end machines. For example, from each machine run:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:132
# 6f88d13486f54e149f829b6936eed1b0
msgid "Upgrade the secondary back end machine."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:138
# 9b75de0ed35f45f0a6f7200a1d4e5093
msgid "Upgrade all frontend machines."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:144
# b8645048e281407aa6cb703c5806b62a
msgid "Run the following on all machines to make sure all services are started."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:150
# 26bb350a0b1145d1b481e94174174036
msgid "After the upgrade process is complete, and the state of the system after the upgrade has been tested and verified, remove old data on all machines."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:158
# 592afa3369784e7e9321d0b91e85e421
msgid "Runit Process Structure and Checks"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:160
# e607684e7bde41e0b9331b00155f82c3
msgid "Please use the following diagram to understand the runit process supervision tree. All runit components can be inspected with ``ps aux | grep [s]v``::"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:170
# 27a8b8eb649f400ebeca639d9bb8c70a
msgid "In the diagram above, the Upstart config file is located at ``/etc/init/opscode-runsvdir`` on pre-|chef server oec| 11, and at ``/etc/init/private-chef-runsvdir`` in |chef server oec| 11.1.3+."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:172
# 9a3359419db04c31b153160d1369e862
msgid "Between upgrades from major version to major version of |chef private| or |chef server oec|, you will want to check that the ``ps aux | grep [r]unsvdir`` output looks similar to:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:181
# be686a37b5544951bdd4e1a41fca0076
msgid "and not similar to:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:191
# 8555dcab2f5943bab7546007aa263ec0
msgid "Any number of issues can occur with the runsvdir process in |runit|. The most common in an |chef private| or |chef server oec| setting are these:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:193
# eb9e0e34ae2543469067ec818605d5d9
msgid "In |chef private| 1.4.6+, ``/var/log/opscode`` should have ``755`` permissions, but it doesn't"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:194
# 42af1ad968ca4a008436860dd2f2d770
msgid "Any of the ``/var/log/opscode/SERVICE/current`` files are missing"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:195
# 93c19f7df0bc4ac49bc5844019b6431b
msgid "In |chef server oec|, the ownership of ``/var/log/opscode`` is not ``opscode``, so the processes cannot read/write their log files"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:196
# 9d21d339014441a58d7f6d726cbcb8c0
msgid "The filesystem where the logs are stored is full"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:198
# a7d51b16ffc0443f9231a8f2dd4a6260
msgid "When this type of problem is encountered, the process is to check the error output in the process list as above, and figure out what has gone wrong for either the runsvdir, or its svlogd processes, or both. Correct the issue, shutdown |chef private| or |chef server oec|, then use |upstart| to restart runsvdir:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:204
# 08f27a0e3cc64b26b43758c7f428387c
msgid "Restart the runsvdir:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:206
# d77874a10ec541b6b283069185ad3e2a
msgid "For |chef private| 1.4.6+ on RHEL6 and ubuntu10.04+ ``initctl stop opscode-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:207
# e75e1f53f945446bb8b9f597f5aff304
msgid "For |chef server oec| 11.x on RHEL6 and ubuntu10.04+ ``initctl stop private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:209
# 774d1df770814ce7939dee1540662aa9
msgid "During the upgrade of |chef private| 1.4.6+ -> |chef server oec| 11.1.3+, you may have both of the above."
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:211
# 43afcf03584a421fbc2a24adda8cfe35
msgid "If continuing an |chef server oec| 11.1.3+ upgrade ``initctl start private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:212
# f765180997ee48378e9459cf4a216584
msgid "If fixing up an |chef private| 1.4.6+ system before an upgrade to |chef server oec| 11.1.3+ ``initctl start private-chef-runsvdir``"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:215
# 2e8d6c435c724509977376738ee05418
msgid "Example"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:216
# d604f2bf488e455ab63281c7cade1b4f
msgid "The following is one specific problem-fix scenario encountered while proceeding through an |chef private| 1.4.6+ -> |chef server oec| 11.1.3+ upgrade. The issue was likely triggered by an unhealthy |runit| status while running at version |chef private| 1.4.6+::"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:253
# fb14b48e037347db9f2865578b12b646
msgid "OC-11490 patch for |chef server oec| 11.1.3+"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:254
# a2574bf0210d498f9b49c5df3f9c0c1e
msgid "The following is the code for the ``OC-11490.patch`` file:"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:302
# c6a3017752254e31bb85b2dfb220c258
msgid "upgrade.rb"
msgstr ""

#: ../source/upgrade_server_ha_notes.rst:303
# 9f531a4327f1446b997edfb8b6a9aa1f
msgid "The following is the code for the ``upgrade.rb`` file:"
msgstr ""

