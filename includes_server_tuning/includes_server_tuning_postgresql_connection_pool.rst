.. The contents of this file are included in multiple topics.
.. This file should not be changed in a way that hinders its ability to appear in multiple documentation sets.

If there are more than two front end machines in a cluster, the ``postgresql['max_connections']`` setting should be increased. The increased value depends on the number of machines in the front end, but also the number of services that are running on each of these machines. Each front end machine always runs the |service bifrost| and |service erchef| services. The |reporting| add-on adds the |service reporting| service. The |push jobs| service adds the |service push_jobs| service. Each of these services requires 25 connections, above the default value.

Use the following formula to help determine what the increased value should be:

.. code-block:: ruby

   new_value = current_value + [(# of front end machines - 2) * (20 * # of services)]

For example, if the current value is 350, there are four front end machines, and all add-ons are installed, then the formula looks like:

.. code-block:: ruby

   550 = 350 + [(4 - 2) * (25 * 4)]
