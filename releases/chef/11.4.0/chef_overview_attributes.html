

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>About Attributes &mdash; Chef Docs</title>
    
    <link rel="stylesheet" href="_static/opscode.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.1-1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/opscode.ico"/>
    <link rel="top" title="Chef Docs" href="index.html" />
    <link rel="next" title="Public and Private Keys" href="chef_private_keys.html" />
    <link rel="prev" title="Workstations" href="chef_overview_workstation.html" /> 
  </head>
  <body>
<div style="background-color: #212c35; text-align: left; padding: 0px 0px 0px 0px">
<a href="http://docs.opscode.com/"><img src="_static/opscode_html_logo.png" border="0" alt="Opscode"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="chef_private_keys.html" title="Public and Private Keys"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="chef_overview_workstation.html" title="Workstations"
             accesskey="P">previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/opscode_chef_html_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">About Attributes</a><ul>
<li><a class="reference internal" href="#attribute-types">Attribute Types</a></li>
<li><a class="reference internal" href="#attribute-sources">Attribute Sources</a><ul>
<li><a class="reference internal" href="#automatic-ohai">Automatic (Ohai)</a></li>
<li><a class="reference internal" href="#attribute-files">Attribute Files</a></li>
<li><a class="reference internal" href="#recipes">Recipes</a></li>
<li><a class="reference internal" href="#roles">Roles</a></li>
<li><a class="reference internal" href="#environments">Environments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#attribute-precedence">Attribute Precedence</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="about-attributes">
<h1>About Attributes<a class="headerlink" href="#about-attributes" title="Permalink to this headline">¶</a></h1>
<p>An attribute is a specific detail about a node. Attributes are used by Chef to understand:</p>
<ul class="simple">
<li>The current state of the node</li>
<li>What the state of the node was at the end of the previous Chef run</li>
<li>What the state of the node should be at the end of the current Chef run</li>
</ul>
<p>Attributes are defined by:</p>
<ul class="simple">
<li>The state of the node itself</li>
<li>Cookbooks (in attribute files and/or recipes)</li>
<li>Roles</li>
<li>Environments</li>
</ul>
<p>During every Chef run, the chef-client builds the attribute list using:</p>
<ul class="simple">
<li>Data about the node collected by Ohai</li>
<li>The node object that was saved to the Chef Server at the end of the previous Chef run</li>
<li>The rebuilt node object from the current Chef run, after it is updated for changes to cookbooks (attribute files and/or recipes), roles, and/or environments, and updated for any changes to the state of the node itself</li>
</ul>
<p>After the node object is rebuilt, all of attributes are compared, and then the node is updated based on attribute precedence. At the end of every Chef run, the node object that defines the current state of the node is uploaded to the Chef Server so that it can be indexed for search.</p>
<p>Chef uses six types of attributes to determine the value that is applied to a node during the Chef run. In addition, Chef sources attribute values from up to five locations. The combination of attribute types and sources allows for up to 15 different competing values to be available to Chef during the Chef run.</p>
<p>So how does Chef determine which value should be applied? Keep reading to learn more about how attributes work with Chef, including more about the types of attributes, where attributes are saved, and how Chef chooses which attribute to apply.</p>
<div class="section" id="attribute-types">
<h2>Attribute Types<a class="headerlink" href="#attribute-types" title="Permalink to this headline">¶</a></h2>
<p>Attribute types can be any of the following:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">default</span></tt></td>
<td>A <tt class="docutils literal"><span class="pre">default</span></tt> attribute is automatically reset at the start of every Chef run and has the lowest attribute precedence. A cookbook should be authored to use <tt class="docutils literal"><span class="pre">default</span></tt> attributes as often as possible.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">force_default</span></tt></td>
<td>A <tt class="docutils literal"><span class="pre">force_default</span></tt> attribute is used to ensure that an attribute defined in a cookbook (by an attribute file or by a recipe) takes precedence over a <tt class="docutils literal"><span class="pre">default</span></tt> attribute set by a role or an environment.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">normal</span></tt></td>
<td>A <tt class="docutils literal"><span class="pre">normal</span></tt> attribute is a setting that persists on the target system and is never reset during a Chef run. A <tt class="docutils literal"><span class="pre">normal</span></tt> attribute has a higher attribute precedence than a <tt class="docutils literal"><span class="pre">default</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">override</span></tt></td>
<td>An <tt class="docutils literal"><span class="pre">override</span></tt> attribute is automatically reset at the start of every Chef run and has a higher attribute precedence than <tt class="docutils literal"><span class="pre">default</span></tt>, <tt class="docutils literal"><span class="pre">force_default</span></tt>, and <tt class="docutils literal"><span class="pre">normal</span></tt> attributes. An <tt class="docutils literal"><span class="pre">override</span></tt> attribute is most often specified in a recipe, but can be specified in an attribute file, for a role, and/or for an environment. A cookbook should be authored so that it uses <tt class="docutils literal"><span class="pre">override</span></tt> attributes only when required.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">force_override</span></tt></td>
<td>A <tt class="docutils literal"><span class="pre">force_override</span></tt> attribute is used to ensure that an attribute defined in a cookbook (by an attribute file or by a recipe) takes precedence over an <tt class="docutils literal"><span class="pre">override</span></tt> attribute set by a role or an environment.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">automatic</span></tt></td>
<td>An <tt class="docutils literal"><span class="pre">automatic</span></tt> attribute contains data that is identified by Ohai at the beginning of every Chef run. An <tt class="docutils literal"><span class="pre">automatic</span></tt> attribute cannot be modified and always has the highest attribute precedence.</td>
</tr>
</tbody>
</table>
<p>At the beginning of a Chef run, all default, override, and automatic attributes are reset. Chef rebuilds them using data collected by Ohai at the beginning of the Chef run and by attributes that are defined in cookbooks, roles, and environments. Normal attributes are never reset. All attributes are then merged and applied to the node according to attribute precedence. At the conclusion of the Chef run, all default, override, and automatic attributes disappear, leaving only a collection of normal attributes that will persist until the next Chef run.</p>
</div>
<div class="section" id="attribute-sources">
<h2>Attribute Sources<a class="headerlink" href="#attribute-sources" title="Permalink to this headline">¶</a></h2>
<p>Attributes are provided to Chef from the following locations:</p>
<ul class="simple">
<li>Nodes (collected by Ohai at the start of each Chef run)</li>
<li>Attribute files (in cookbooks)</li>
<li>Recipes (in cookbooks)</li>
<li>Environments</li>
<li>Roles</li>
</ul>
<p>If we go back to the <a class="reference external" href="http://docs.opscode.com/chef_overview.html">overview of Chef</a>, but then focus only on where attributes are located, it looks something like this:</p>
<img alt="_images/overview_chef_attributes.png" src="_images/overview_chef_attributes.png" />
<p>where:</p>
<ul class="simple">
<li>Many attributes are maintained in the Chef repository for environments, roles, and cookbooks (attribute files and recipes)</li>
<li>Many attributes are collected by Ohai on each individual node at the start of every Chef run</li>
<li>The attributes that are maintained in the Chef repository are uploaded to the Chef Server from the workstation, periodically</li>
<li>The chef-client will pull down the node object from the Chef Server (which contains the attribute data from the previous Chef run), after which all attributes (except <tt class="docutils literal"><span class="pre">normal</span></tt> are reset)</li>
<li>The chef-client will update the cookbooks on the node (if required), which updates the attributes contained in attribute files and recipes</li>
<li>The chef-client will update the role and environment data (if required)</li>
<li>The chef-client will rebuild the attribute list and apply attribute precedence while configuring the node</li>
<li>The chef-client pushes the node object to the Chef Server at the end of the Chef run; the updated node object on the Chef Server is then indexed for search and is stored until the next Chef run</li>
</ul>
<div class="section" id="automatic-ohai">
<h3>Automatic (Ohai)<a class="headerlink" href="#automatic-ohai" title="Permalink to this headline">¶</a></h3>
<p>An automatic attribute is a specific detail about a node, such as an IP address, a host name, a list of loaded kernel modules, and so on. Automatic attributes are detected by Ohai and are then used by Chef to ensure that these attribute are handled properly during every Chef run. The most commonly accessed automatic attributes are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node['platform']</span></tt></td>
<td>The platform on which a node is running. This attribute helps determine which providers will be used.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">node['platform_version']</span></tt></td>
<td>The version of the platform. This attribute helps determine which providers will be used.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node['ipaddress']</span></tt></td>
<td>The IP address for a node. If the node has a default route, this is the IPV4 address for the interface. If the node does not have a default route, the value for this attribute should be <tt class="docutils literal"><span class="pre">nil</span></tt>. The IP address for default route is the recommended default value.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">node['macaddress']</span></tt></td>
<td>The MAC address for a node, determined by the same interface that detects the <tt class="docutils literal"><span class="pre">node['ipaddress']</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node['fqdn']</span></tt></td>
<td>The fully qualified domain name for a node. This is used as the name of a node unless otherwise set.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">node['hostname']</span></tt></td>
<td>The host name for the node.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node['domain']</span></tt></td>
<td>The domain for the node.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">node['recipes']</span></tt></td>
<td>A list of recipes associated with a node (and part of that node&#8217;s run-list).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node['roles']</span></tt></td>
<td>A list of roles associated with a node (and part of that node&#8217;s run-list).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">node['ohai_time']</span></tt></td>
<td>The time at which Ohai was last run. This attribute is not commonly used in recipes, but it is saved to the Chef Server and can be accessed using the <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">status</span></tt> sub-command.</td>
</tr>
</tbody>
</table>
<p>The list of automatic attributes that are collected by Ohai at the start of each Chef run vary from organization to organization, and will often vary between the various server types being configured and the platforms on which those servers are run. All attributes collected by Ohai are unmodifiable. To see which automatic attributes are collected by Ohai for a particular node, run the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre>ohai<span class="nv">$ </span>grep -R <span class="s2">&quot;provides&quot;</span> -h lib/ohai/plugins|sed <span class="s1">&#39;s/^\s*//g&#39;</span>|sed <span class="s2">&quot;s/\\\&quot;/\&#39;/g&quot;</span>|sort|uniq|grep ^provides
</pre></div>
</div>
</div>
<div class="section" id="attribute-files">
<h3>Attribute Files<a class="headerlink" href="#attribute-files" title="Permalink to this headline">¶</a></h3>
<p>An attribute file is located in the <tt class="docutils literal"><span class="pre">attributes/</span></tt> sub-directory for a cookbook. When a cookbook is run against a node, the attributes contained in all attribute files are evaluated in the context of the node object. Node methods (when present) are used to set attribute values on a node. For example, the Apache cookbook contains an attribute file called <tt class="docutils literal"><span class="pre">default.rb</span></tt>, which contains the following attributes:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">default</span><span class="o">[</span><span class="s2">&quot;apache&quot;</span><span class="o">][</span><span class="s2">&quot;dir&quot;</span><span class="o">]</span>          <span class="o">=</span> <span class="s2">&quot;/etc/apache2&quot;</span>
<span class="n">default</span><span class="o">[</span><span class="s2">&quot;apache&quot;</span><span class="o">][</span><span class="s2">&quot;listen_ports&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="o">[</span> <span class="s2">&quot;80&quot;</span><span class="p">,</span><span class="s2">&quot;443&quot;</span> <span class="o">]</span>
</pre></div>
</div>
<p>The use of the node object (<tt class="docutils literal"><span class="pre">node.</span></tt>) is implicit in the previous example; the following example defines the node object itself as part of the attribute:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">node</span><span class="o">.</span><span class="n">default</span><span class="o">[</span><span class="s2">&quot;apache&quot;</span><span class="o">][</span><span class="s2">&quot;dir&quot;</span><span class="o">]</span>          <span class="o">=</span> <span class="s2">&quot;/etc/apache2&quot;</span>
<span class="n">node</span><span class="o">.</span><span class="n">default</span><span class="o">[</span><span class="s2">&quot;apache&quot;</span><span class="o">][</span><span class="s2">&quot;listen_ports&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="o">[</span> <span class="s2">&quot;80&quot;</span><span class="p">,</span><span class="s2">&quot;443&quot;</span> <span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="recipes">
<h3>Recipes<a class="headerlink" href="#recipes" title="Permalink to this headline">¶</a></h3>
<p>A recipe is the most fundamental configuration element within the Chef environment. A recipe:</p>
<ul class="simple">
<li>Is authored using Ruby, which is a programming language designed to read and behave in a predictable manner</li>
<li>Is mostly a collection of resources in a Ruby syntax with some helper code around it</li>
<li>Must define everything that is required to configure part of a system</li>
<li>Must be stored in a cookbook</li>
<li>May be included in a recipe</li>
<li>May use the results of a search query and read the contents of a data bag (including an encrypted data bag)</li>
<li>May have a dependency on one (or more) recipes</li>
<li>May be tagged to facilitate the creation of arbitrary groupings that exist outside of the normal naming conventions an organization may have</li>
<li>Must be added to a run-list before it can be used by Chef</li>
<li>Is always executed in the same order as listed in a run-list</li>
</ul>
<p>An attribute can be defined in a cookbook (or a recipe) and then used to override the default settings on a node. When a cookbook is loaded during a Chef run, these attributes are compared to the attributes that are already present on the node. When the cookbook attributes take precedence over the default attributes, Chef will apply those new settings and values during the Chef run on the node.</p>
</div>
<div class="section" id="roles">
<h3>Roles<a class="headerlink" href="#roles" title="Permalink to this headline">¶</a></h3>
<p>A role is a way to define certain patterns and processes that exist across nodes in a Chef organization as belonging to a single job function. Each role consists of zero (or more) attributes and a run list. Each node can have zero (or more) roles assigned to it. When a role is run against a node, the configuration details of that node are compared against the attributes of the role, and then the contents of that role&#8217;s run list are applied to the node&#8217;s configuration details. When a chef-client runs, it merges its own attributes and run lists with those contained within each assigned role.</p>
<p>An attribute can be defined in a role and then used to override the default settings on a node. When a role is applied during a Chef run, these attributes are compared to the attributes that are already present on the node. When the role attributes take precedence over the default attributes, Chef will apply those new settings and values during the Chef run on the node.</p>
<p>A role attribute can only be set to be a default attribute or an override attribute. A role attribute cannot be set to be a normal attribute. Use the <tt class="docutils literal"><span class="pre">default_attribute</span></tt> and <tt class="docutils literal"><span class="pre">override_attribute</span></tt> methods in the Ruby DSL file or the <tt class="docutils literal"><span class="pre">default_attributes</span></tt> and <tt class="docutils literal"><span class="pre">override_attributes</span></tt> hashes in a JSON data file.</p>
</div>
<div class="section" id="environments">
<h3>Environments<a class="headerlink" href="#environments" title="Permalink to this headline">¶</a></h3>
<p>An environment is a way to map an organization&#8217;s real-life workflow to what can be configured and managed when using Chef Server. Every Chef organization begins with a single environment called the <tt class="docutils literal"><span class="pre">_default</span></tt> environment, which cannot be modified (or deleted). Additional environments can be created, such as production, staging, testing, and development. Generally, an environment is also associated with one (or more) cookbook versions.</p>
<p>An attribute can be defined in an environment and then used to override the default settings on a node. When an environment is applied during a Chef run, these attributes are compared to the attributes that are already present on the node. When the environment attributes take precedence over the default attributes, Chef will apply those new settings and values during the Chef run on the node.</p>
<p>An environment attribute can only be set to be a default attribute or an override attribute. An environment attribute cannot be set to be a normal attribute. Use the <tt class="docutils literal"><span class="pre">default_attribute</span></tt> and <tt class="docutils literal"><span class="pre">override_attribute</span></tt> methods in the Ruby DSL file or the <tt class="docutils literal"><span class="pre">default_attributes</span></tt> and <tt class="docutils literal"><span class="pre">override_attributes</span></tt> hashes in a JSON data file.</p>
</div>
</div>
<div class="section" id="attribute-precedence">
<h2>Attribute Precedence<a class="headerlink" href="#attribute-precedence" title="Permalink to this headline">¶</a></h2>
<p>Attributes are always applied to Chef in the following order:</p>
<ol class="arabic simple">
<li>A <tt class="docutils literal"><span class="pre">default</span></tt> attribute located in an attribute file</li>
<li>A <tt class="docutils literal"><span class="pre">default</span></tt> attribute located in a recipe</li>
<li>A <tt class="docutils literal"><span class="pre">default</span></tt> attribute located in an environment</li>
<li>A <tt class="docutils literal"><span class="pre">default</span></tt> attribute located in role</li>
<li>A <tt class="docutils literal"><span class="pre">force_default</span></tt> attribute located in an attribute file</li>
<li>A <tt class="docutils literal"><span class="pre">force_default</span></tt> attribute located in a recipe</li>
<li>A <tt class="docutils literal"><span class="pre">normal</span></tt> attribute located in an attribute file</li>
<li>A <tt class="docutils literal"><span class="pre">normal</span></tt> attribute located in a recipe</li>
<li>An <tt class="docutils literal"><span class="pre">override</span></tt> attribute located in an attribute file</li>
<li>An <tt class="docutils literal"><span class="pre">override</span></tt> attribute located in a recipe</li>
<li>An <tt class="docutils literal"><span class="pre">override</span></tt> attribute located in a role</li>
<li>An <tt class="docutils literal"><span class="pre">override</span></tt> attribute located in an environment</li>
<li>A <tt class="docutils literal"><span class="pre">force_override</span></tt> attribute located in an attribute file</li>
<li>A <tt class="docutils literal"><span class="pre">force_override</span></tt> attribute located in a recipe</li>
<li>An <tt class="docutils literal"><span class="pre">automatic</span></tt> attribute identified by Ohai at the start of the Chef run</li>
</ol>
<p>where the last attribute in the list is the one that is applied to the node.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The attribute precedence order for roles and environments is reversed for <tt class="docutils literal"><span class="pre">default</span></tt> and <tt class="docutils literal"><span class="pre">override</span></tt> attributes. The precedence order for <tt class="docutils literal"><span class="pre">default</span></tt> attributes is environment, then role. The precedence order for <tt class="docutils literal"><span class="pre">override</span></tt> attributes is role, then environment. Applying environment <tt class="docutils literal"><span class="pre">override</span></tt> attributes after role <tt class="docutils literal"><span class="pre">override</span></tt> attributes allows a role to exist in multiple environments.</p>
</div>
<p>Attribute precedence, viewed from the same perspective as the Chef overview diagram, where the numbers in the diagram match the order of attribute precedence:</p>
<img alt="_images/overview_chef_attributes_precedence.png" src="_images/overview_chef_attributes_precedence.png" />
<p>Attribute precedence, when viewed as a table:</p>
<img alt="_images/overview_chef_attributes_table.png" src="_images/overview_chef_attributes_table.png" />
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>The following examples are listed from low to high precedence.</p>
<p><strong>Default attribute in /attributes/default.rb</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">default</span><span class="o">[</span><span class="s2">&quot;apache&quot;</span><span class="o">][</span><span class="s2">&quot;dir&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/apache2&quot;</span>
</pre></div>
</div>
<p><strong>Default attribute in /environments/environment_name.rb</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">default_attributes</span><span class="p">({</span> <span class="s2">&quot;apache&quot;</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="s2">&quot;dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;/etc/apache2&quot;</span><span class="p">}})</span>
</pre></div>
</div>
<p><strong>Default attribute in /roles/role_name.rb</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">default_attributes</span><span class="p">({</span> <span class="s2">&quot;apache&quot;</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="s2">&quot;dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;/etc/apache2&quot;</span><span class="p">}})</span>
</pre></div>
</div>
<p><strong>Default attribute in node object in recipe</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">node</span><span class="o">.</span><span class="n">default</span><span class="o">[</span><span class="s2">&quot;apache&quot;</span><span class="o">][</span><span class="s2">&quot;dir&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/apache2&quot;</span>
</pre></div>
</div>
<p><strong>Normal attribute set as a cookbook attribute</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">set</span><span class="o">[</span><span class="s2">&quot;apache&quot;</span><span class="o">][</span><span class="s2">&quot;dir&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/apache2&quot;</span>
<span class="n">normal</span><span class="o">[</span><span class="s2">&quot;apache&quot;</span><span class="o">][</span><span class="s2">&quot;dir&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/apache2&quot;</span>  <span class="c1">#set is an alias of normal.</span>
</pre></div>
</div>
<p><strong>Normal attribute set in a recipe</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">node</span><span class="o">.</span><span class="n">set</span><span class="o">[</span><span class="s2">&quot;apache&quot;</span><span class="o">][</span><span class="s2">&quot;dir&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/apache2&quot;</span>

<span class="n">node</span><span class="o">.</span><span class="n">normal</span><span class="o">[</span><span class="s2">&quot;apache][&quot;</span><span class="n">dir</span><span class="s2">&quot;] = &quot;</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apache2</span><span class="s2">&quot; # Same as above</span>
<span class="s2">node[&quot;</span><span class="n">apache</span><span class="s2">&quot;][&quot;</span><span class="n">dir</span><span class="s2">&quot;] = &quot;</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apache2</span><span class="s2">&quot;       # Same as above</span>
</pre></div>
</div>
<p><strong>Override attribute in /attributes/default.rb</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">override</span><span class="o">[</span><span class="s2">&quot;apache&quot;</span><span class="o">][</span><span class="s2">&quot;dir&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/apache2&quot;</span>
</pre></div>
</div>
<p><strong>Override attribute in /roles/role_name.rb</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">override_attributes</span><span class="p">({</span> <span class="s2">&quot;apache&quot;</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="s2">&quot;dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;/etc/apache2&quot;</span><span class="p">}})</span>
</pre></div>
</div>
<p><strong>Override attribute in /environments/environment_name.rb</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">override_attributes</span><span class="p">({</span> <span class="s2">&quot;apache&quot;</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="s2">&quot;dir&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;/etc/apache2&quot;</span><span class="p">}})</span>
</pre></div>
</div>
<p><strong>Override attribute in a node object (from a recipe)</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">node</span><span class="o">.</span><span class="n">override</span><span class="o">[</span><span class="s2">&quot;apache&quot;</span><span class="o">][</span><span class="s2">&quot;dir&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/apache2&quot;</span>
</pre></div>
</div>
<p><strong>Ensure that a default attribute has precedence over other attributes</strong></p>
<p>When a default attribute is set like this:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">default</span><span class="o">[</span><span class="s2">&quot;attribute&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span>
</pre></div>
</div>
<p>any value set by a role or an environment will replace it. To prevent this value from being replaced, use the <tt class="docutils literal"><span class="pre">force_default</span></tt> attribute precedence:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">force_default</span><span class="o">[</span><span class="s2">&quot;attribute&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;I will crush you, role or environment attribute&quot;</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">default!</span><span class="o">[</span><span class="s2">&quot;attribute&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;The &#39;!&#39; means I win!&quot;</span>
</pre></div>
</div>
<p><strong>Ensure that an override attribute has precedence over other attributes</strong></p>
<p>When an override attribute is set like this:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">override</span><span class="o">[</span><span class="s2">&quot;attribute&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span>
</pre></div>
</div>
<p>any value set by a role or an environment will replace it. To prevent this value from being replaced, use the <tt class="docutils literal"><span class="pre">force_override</span></tt> attribute precedence:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">force_override</span><span class="o">[</span><span class="s2">&quot;attribute&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;I will crush you, role or environment attribute&quot;</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">override!</span><span class="o">[</span><span class="s2">&quot;attribute&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;The &#39;!&#39; means I win!&quot;</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="chef_private_keys.html" title="Public and Private Keys"
             >next</a></li>
        <li class="right" >
          <a href="chef_overview_workstation.html" title="Workstations"
             >previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>
 
      </ul>
    </div>

    <div class="footer">
    This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>


    <div class="footer">
        &copy; Copyright This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>

<!-- Start of Async Google Analytics Code -->
<script type="text/javascript">
var _gaq = _gaq || [];
var pluginUrl = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.') + 'google-analytics.com/plugins/ga/inpage_linkid.js';
_gaq.push(['_setAccount', 'UA-6369228-7']);
_gaq.push(['_setDomainName', '.opscode.com']);
_gaq.push(['_setAllowHash', false]);
_gaq.push(['_setAllowLinker', true]);
_gaq.push(['_addIgnoredRef','opscode.com']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript';
  ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(ga, s); })();
</script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Async HubSpot Analytics Code -->
<script type="text/javascript">
(function(d,s,i,r) {
            if (d.getElementById(i)){return;}
            var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
            n.id=i;n.src='//js.hubspot.com/analytics/'+(Math.ceil(new Date()/r)*r)+'/57718.js';
            e.parentNode.insertBefore(n, e);
        })(document,"script","hs-analytics",300000);
    </script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Contact Analytics Code -->
<script type="text/javascript">
(function() {
  var didInit = false;
  function initMunchkin() {
    if(didInit === false) {
      didInit = true;
      Munchkin.init('255-VFB-268');
    }
  }
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
  s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
      initMunchkin();
    }
  };
  s.onload = initMunchkin;
  document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
<!-- End of Contact Analytics Code -->


  </body>
</html>