

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>/search/INDEX &mdash; Chef Docs</title>
    
    <link rel="stylesheet" href="_static/opscode.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.1-1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/opscode.ico"/>
    <link rel="top" title="Chef Docs" href="index.html" />
    <link rel="up" title="Chef Server API" href="api_chef_server.html" />
    <link rel="next" title="/user" href="api_chef_server_user.html" />
    <link rel="prev" title="/search" href="api_chef_server_search.html" /> 
  </head>
  <body>
<div style="background-color: #212c35; text-align: left; padding: 0px 0px 0px 0px">
<a href="http://docs.opscode.com/"><img src="_static/opscode_html_logo.png" border="0" alt="Opscode"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="api_chef_server_user.html" title="/user"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="api_chef_server_search.html" title="/search"
             accesskey="P">previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>

          <li><a href="api_chef_server.html" accesskey="U">Chef Server API</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/opscode_chef_html_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">/search/INDEX</a><ul>
<li><a class="reference internal" href="#get">GET</a></li>
<li><a class="reference internal" href="#post">POST</a></li>
</ul>
</li>
</ul>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="search-index">
<h1>/search/INDEX<a class="headerlink" href="#search-index" title="Permalink to this headline">¶</a></h1>
<p>Use the <tt class="docutils literal"><span class="pre">/search/INDEX</span></tt> endpoint to access the search indexes on the Chef Server. The <tt class="docutils literal"><span class="pre">/search/INDEX</span></tt> endpoint has the following methods: <tt class="docutils literal"><span class="pre">GET</span></tt> and <tt class="docutils literal"><span class="pre">POST</span></tt>.</p>
<p>A search query is comprised of two parts: the key and the search pattern. A search query has the following syntax:</p>
<div class="highlight-python"><pre>key:search_pattern</pre>
</div>
<p>where <tt class="docutils literal"><span class="pre">key</span></tt> is a field name that is found in the JSON description of an indexable object on the Chef Server (a role, node, client, environment, or data bag) and <tt class="docutils literal"><span class="pre">search_pattern</span></tt> defines what will be searched for, using one of the following search patterns: exact, wildcard, range, or fuzzy matching. Both <tt class="docutils literal"><span class="pre">key</span></tt> and <tt class="docutils literal"><span class="pre">search_pattern</span></tt> are case-sensitive; <tt class="docutils literal"><span class="pre">key</span></tt> has limited support for multiple character wildcard matching using an asterisk (*) (and as long as it is not the first character).</p>
<div class="section" id="get">
<h2>GET<a class="headerlink" href="#get" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">GET</span></tt> method is used to return all of the data that matches the query in the <tt class="docutils literal"><span class="pre">GET</span></tt> request.</p>
<p>This method has the following parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">q</span></tt></td>
<td>The search query used to identify a a list of items on a Chef Server. This option uses the same syntax as the <tt class="docutils literal"><span class="pre">search</span></tt> sub-command.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">rows</span></tt></td>
<td>The number of rows to be returned.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">sort</span></tt></td>
<td>The order in which search results will be sorted.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">start</span></tt></td>
<td>The row at which return results will begin.</td>
</tr>
</tbody>
</table>
<p><strong>Request</strong></p>
<div class="highlight-xml"><div class="highlight"><pre>GET /search/INDEX
</pre></div>
</div>
<p><strong>Response</strong></p>
<p>The response contains the total number of rows that match the request and will return something like the following:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
 <span class="s2">&quot;total&quot;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s2">&quot;start&quot;</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s2">&quot;rows&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
     <span class="s2">&quot;overrides&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;hardware_type&quot;</span><span class="o">:</span> <span class="s2">&quot;laptop&quot;</span><span class="p">},</span>
     <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;latte&quot;</span><span class="p">,</span>
     <span class="s2">&quot;chef_type&quot;</span><span class="o">:</span> <span class="s2">&quot;node&quot;</span><span class="p">,</span>
     <span class="s2">&quot;json_class&quot;</span><span class="o">:</span> <span class="s2">&quot;Chef::Node&quot;</span><span class="p">,</span>
     <span class="s2">&quot;attributes&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;hardware_type&quot;</span><span class="o">:</span> <span class="s2">&quot;laptop&quot;</span><span class="p">},</span>
     <span class="s2">&quot;run_list&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;recipe[unicorn]&quot;</span><span class="p">],</span>
     <span class="s2">&quot;defaults&quot;</span><span class="o">:</span> <span class="p">{}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Response Codes</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Response Code</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">200</span></tt></td>
<td>OK. The request was successful.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">401</span></tt></td>
<td>Unauthorized. The user which made the request is not authorized to perform the action.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">403</span></tt></td>
<td>Forbidden. The user which made the request is not authorized to perform the action.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">404</span></tt></td>
<td>Not found. The requested object does not exist.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="post">
<h2>POST<a class="headerlink" href="#post" title="Permalink to this headline">¶</a></h2>
<p>A partial search query allows a search query to be made against specific attribute keys that are stored on the Chef Server. A partial search query can search the same set of objects on the Chef Server as a full search query, including specifying an object index and providing a query that can be matched to the relevant index. While a full search query will return an array of objects that match (each object containing a full set of attributes for the node), a partial search query will return only the values for the attributes that match. One primary benefit of using a partial search query is that it requires less memory and network bandwidth while the chef-client processes the search results.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To use the <tt class="docutils literal"><span class="pre">partial_search</span></tt> method in a recipe, that recipe must contain a dependency on the <tt class="docutils literal"><span class="pre">partial_search</span></tt> cookbook.</p>
</div>
<p>To create a partial search query, use the <tt class="docutils literal"><span class="pre">partial_search</span></tt> method, and then specify the key paths for the attributes to be returned. Each key path should be specified as an array of strings and is mapped to an arbitrary short name. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">partial_search</span><span class="p">(</span><span class="ss">:node</span><span class="p">,</span> <span class="s1">&#39;role:web&#39;</span><span class="p">,</span>
  <span class="ss">:keys</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;name&#39;</span> <span class="o">]</span><span class="p">,</span>
             <span class="s1">&#39;ip&#39;</span>   <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;ipaddress&#39;</span> <span class="o">]</span><span class="p">,</span>
             <span class="s1">&#39;kernel_version&#39;</span> <span class="o">=&gt;</span> <span class="o">[</span> <span class="s1">&#39;kernel&#39;</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span> <span class="o">]</span>
           <span class="p">}</span>
<span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">result</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;name&#39;</span><span class="o">]</span>
  <span class="nb">puts</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;ip&#39;</span><span class="o">]</span>
  <span class="nb">puts</span> <span class="n">result</span><span class="o">[</span><span class="s1">&#39;kernel_version&#39;</span><span class="o">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p>In the previous example, two attributes will be extracted (on the Chef Server) from any node that matches the search query. The result will be a simple hash with keys <tt class="docutils literal"><span class="pre">name</span></tt>, <tt class="docutils literal"><span class="pre">ip</span></tt>, and <tt class="docutils literal"><span class="pre">kernel_version</span></tt>.</p>
<p>The <tt class="docutils literal"><span class="pre">POST</span></tt> method is used to return partial search results. For example, if a node has the following:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s1">&#39;x&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
  <span class="s1">&#39;kernel&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;a&#39;</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>a partial search query can be used to return something like:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span> <span class="s1">&#39;kernel_version&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
<p>This method has the following parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">q</span></tt></td>
<td>The search query used to identify a a list of items on a Chef Server. This option uses the same syntax as the <tt class="docutils literal"><span class="pre">search</span></tt> sub-command.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">rows</span></tt></td>
<td>The number of rows to be returned.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">sort</span></tt></td>
<td>The order in which search results will be sorted.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">start</span></tt></td>
<td>The row at which return results will begin.</td>
</tr>
</tbody>
</table>
<p><strong>Request</strong></p>
<div class="highlight-xml"><div class="highlight"><pre>GET /search
</pre></div>
</div>
<p>with a request body that looks something like:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s1">&#39;name&#39;</span> <span class="p">],</span>
  <span class="s1">&#39;ip&#39;</span>   <span class="o">=&gt;</span> <span class="p">[</span> <span class="s1">&#39;ipaddress&#39;</span> <span class="p">],</span>
  <span class="s1">&#39;kernel_version&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span> <span class="s1">&#39;kernel&#39;</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Response</strong></p>
<p>The response will return something like the following:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;latte&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ip&quot;</span><span class="o">:</span> <span class="s2">&quot;123.4.5.6789&quot;</span><span class="p">,</span>
  <span class="s2">&quot;kernel_version&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;linux&quot;</span><span class="o">:</span> <span class="s2">&quot;1.2.3&quot;</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Response Codes</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Response Code</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">200</span></tt></td>
<td>OK. The request was successful.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">401</span></tt></td>
<td>Unauthorized. The user which made the request is not authorized to perform the action.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">403</span></tt></td>
<td>Forbidden. The user which made the request is not authorized to perform the action.</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="api_chef_server_user.html" title="/user"
             >next</a></li>
        <li class="right" >
          <a href="api_chef_server_search.html" title="/search"
             >previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>

          <li><a href="api_chef_server.html" >Chef Server API</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
    This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>


    <div class="footer">
        &copy; Copyright This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>

<!-- Start of Async Google Analytics Code -->
<script type="text/javascript">
var _gaq = _gaq || [];
var pluginUrl = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.') + 'google-analytics.com/plugins/ga/inpage_linkid.js';
_gaq.push(['_setAccount', 'UA-6369228-7']);
_gaq.push(['_setDomainName', '.opscode.com']);
_gaq.push(['_setAllowHash', false]);
_gaq.push(['_setAllowLinker', true]);
_gaq.push(['_addIgnoredRef','opscode.com']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript';
  ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(ga, s); })();
</script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Async HubSpot Analytics Code -->
<script type="text/javascript">
(function(d,s,i,r) {
            if (d.getElementById(i)){return;}
            var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
            n.id=i;n.src='//js.hubspot.com/analytics/'+(Math.ceil(new Date()/r)*r)+'/57718.js';
            e.parentNode.insertBefore(n, e);
        })(document,"script","hs-analytics",300000);
    </script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Contact Analytics Code -->
<script type="text/javascript">
(function() {
  var didInit = false;
  function initMunchkin() {
    if(didInit === false) {
      didInit = true;
      Munchkin.init('255-VFB-268');
    }
  }
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
  s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
      initMunchkin();
    }
  };
  s.onload = initMunchkin;
  document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
<!-- End of Contact Analytics Code -->


  </body>
</html>