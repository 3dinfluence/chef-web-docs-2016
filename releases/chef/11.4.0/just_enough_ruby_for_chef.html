

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Just Enough Ruby for Chef &mdash; Chef Docs</title>
    
    <link rel="stylesheet" href="_static/opscode.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.1-1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/opscode.ico"/>
    <link rel="top" title="Chef Docs" href="index.html" />
    <link rel="next" title="Cookbooks" href="chef_overview_cookbooks.html" />
    <link rel="prev" title="What’s New in Chef 11" href="breaking_changes_chef_11.html" /> 
  </head>
  <body>
<div style="background-color: #212c35; text-align: left; padding: 0px 0px 0px 0px">
<a href="http://docs.opscode.com/"><img src="_static/opscode_html_logo.png" border="0" alt="Opscode"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="chef_overview_cookbooks.html" title="Cookbooks"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="breaking_changes_chef_11.html" title="What’s New in Chef 11"
             accesskey="P">previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/opscode_chef_html_logo.png" alt="Logo"/>
            </a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="just-enough-ruby-for-chef">
<h1>Just Enough Ruby for Chef<a class="headerlink" href="#just-enough-ruby-for-chef" title="Permalink to this headline">¶</a></h1>
<p>Ruby is a simple programming language that is designed to be easy to read and to behave in a predictable manner. Chef uses Ruby as its reference language for creating cookbooks and defining recipes, with an extended DSL (domain-specific language) that is used for specific resources. Chef provides a reasonable set of resources, enough to support many of the most common infrastructure automation scenarios; however, this DSL can also be extended when additional resources and capabilities are required.</p>
<p>Chef uses a domain-specific language in Ruby to define recipes and to store settings, such as those which define a role or an environment. These settings are saved as Ruby files and are stored in the Chef repository. When these files are uploaded to the Chef Server, they are converted to JSON. Each time the Chef repository is refreshed, the contents of all domain-specific Ruby files are re-compiled to JSON and are re-uploaded to the Chef Server.</p>
<p>Many people who are new to Ruby often find that it doesn&#8217;t take very long to get up to speed with the basics. For example, it&#8217;s useful to know how to check the syntax of a Ruby file, such as the contents of a cookbook named &#8220;my_cookbook.rb&#8221;:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ruby -c my_cookbook_file.rb
</pre></div>
</div>
<p>to return:</p>
<div class="highlight-bash"><div class="highlight"><pre>Syntax OK
</pre></div>
</div>
<p>Here is a quick rundown of some basic Ruby commands.</p>
<p>Anything after a <tt class="docutils literal"><span class="pre">#</span></tt> is a comment.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="c1"># This is a comment.</span>
</pre></div>
</div>
<p>Assign a local variable:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Do some basic arithmetic:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span>           <span class="c1"># =&gt; 3</span>
<span class="mi">2</span> <span class="o">*</span> <span class="mi">7</span>           <span class="c1"># =&gt; 14</span>
<span class="mi">5</span> <span class="o">/</span> <span class="mi">2</span>           <span class="c1"># =&gt; 2   (because both arguments are whole numbers)</span>
<span class="mi">5</span> <span class="o">/</span> <span class="mi">2</span><span class="o">.</span><span class="mi">0</span>         <span class="c1"># =&gt; 2.5 (because one of the numbers had a decimal place)</span>
<span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>     <span class="c1"># =&gt; 7   (you can use parens to group expressions)</span>
</pre></div>
</div>
<p>Work with strings:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="s1">&#39;single quoted&#39;</span> <span class="c1"># =&gt; &quot;single quoted&quot;</span>
<span class="s2">&quot;double quoted&quot;</span> <span class="c1"># =&gt; &quot;double quoted&quot;</span>
<span class="s1">&#39;It\&#39;s alive&#39;</span>   <span class="c1"># =&gt; &quot;It&#39;s alive!&quot;</span>
<span class="s2">&quot;1 + 2 = 5&quot;</span>     <span class="c1"># =&gt; &quot;1 + 2 = 5&quot; (numbers surrounded by quotes may exhibit string-like behavior)</span>
</pre></div>
</div>
<p>Embed Ruby in a string:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Bob&quot;</span>
<span class="s2">&quot;Hi, </span><span class="si">#{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span>      <span class="c1"># =&gt; &quot;Hi, Bob&quot;</span>
<span class="s1">&#39;Hello, #{x}&#39;</span>   <span class="c1"># =&gt; &quot;Hello, \#{x}&quot; Notice that single quotes don&#39;t work with #{}</span>
</pre></div>
</div>
<p>Work with basic truths:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="kp">true</span>            <span class="c1"># =&gt; true</span>
<span class="kp">false</span>           <span class="c1"># =&gt; false</span>
<span class="kp">nil</span>             <span class="c1"># =&gt; nil</span>
<span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span>          <span class="c1"># =&gt; true ( == tests for equality )</span>
<span class="mi">1</span> <span class="o">==</span> <span class="kp">true</span>       <span class="c1"># =&gt; false ( == tests for equality )</span>
</pre></div>
</div>
<p>Work with basic untruths (<tt class="docutils literal"><span class="pre">!</span></tt> means not!):</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="o">!</span><span class="kp">true</span>           <span class="c1"># =&gt; false</span>
<span class="o">!</span><span class="kp">false</span>          <span class="c1"># =&gt; true</span>
<span class="o">!</span><span class="kp">nil</span>            <span class="c1"># =&gt; true</span>
<span class="mi">1</span> <span class="o">!=</span> <span class="mi">2</span>          <span class="c1"># =&gt; true (1 is not equal to 2)</span>
<span class="mi">1</span> <span class="o">!=</span> <span class="mi">1</span>          <span class="c1"># =&gt; false (1 is not not equal to itself)</span>
</pre></div>
</div>
<p>Convert something to either true or false (<tt class="docutils literal"><span class="pre">!!</span></tt> means not not!!):</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="o">!!</span><span class="kp">true</span>          <span class="c1"># =&gt; true</span>
<span class="o">!!</span><span class="kp">false</span>         <span class="c1"># =&gt; false</span>
<span class="o">!!</span><span class="kp">nil</span>           <span class="c1"># =&gt; false (when pressed, nil is false)</span>
<span class="o">!!</span><span class="mi">0</span>             <span class="c1"># =&gt; true (zero is NOT false).</span>
</pre></div>
</div>
<p>Create lists using arrays:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="o">]</span> <span class="c1"># =&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span>
<span class="n">x</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>                <span class="c1"># =&gt; &quot;a&quot; (zero is the first index)</span>
<span class="n">x</span><span class="o">.</span><span class="n">first</span>             <span class="c1"># =&gt; &quot;a&quot; (see?)</span>
<span class="n">x</span><span class="o">.</span><span class="n">last</span>              <span class="c1"># =&gt; &quot;c&quot;</span>
<span class="n">x</span> <span class="o">+</span> <span class="o">[</span><span class="s2">&quot;d&quot;</span><span class="o">]</span>           <span class="c1"># =&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;]</span>
<span class="n">x</span>                   <span class="c1"># =&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;] ( x is unchanged)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="o">[</span><span class="s2">&quot;d&quot;</span><span class="o">]</span>       <span class="c1"># =&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;]</span>
<span class="n">x</span>                   <span class="c1"># =&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;]</span>
</pre></div>
</div>
<p>A hash is a list with keys and values. Sometimes they don&#8217;t have a set order:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">h</span> <span class="o">=</span> <span class="p">{</span>
<span class="s2">&quot;first_name&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span>
<span class="s2">&quot;last_name&quot;</span>  <span class="o">=&gt;</span> <span class="s2">&quot;Jones&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And sometimes they do. For example, first name then last name:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">h</span><span class="o">.</span><span class="n">keys</span>              <span class="c1"># =&gt; [&quot;first_name&quot;, &quot;last_name&quot;]</span>
<span class="n">h</span><span class="o">[</span><span class="s2">&quot;first_name&quot;</span><span class="o">]</span>     <span class="c1"># =&gt; &quot;Bob&quot;</span>
<span class="n">h</span><span class="o">[</span><span class="s2">&quot;last_name&quot;</span><span class="o">]</span>      <span class="c1"># =&gt; &quot;Jones&quot;</span>
<span class="n">h</span><span class="o">[</span><span class="s2">&quot;age&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="mi">23</span>
<span class="n">h</span><span class="o">.</span><span class="n">keys</span>              <span class="c1"># =&gt; [&quot;first_name&quot;, &quot;age&quot;, &quot;last_name&quot;]</span>
<span class="n">h</span><span class="o">.</span><span class="n">values</span>            <span class="c1"># =&gt; [&quot;Jones&quot;, &quot;Bob&quot;, 23]</span>
</pre></div>
</div>
<p>Use Perl-style regular expressions:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="s2">&quot;I believe&quot;</span>  <span class="o">=~</span> <span class="sr">/I/</span>                       <span class="c1"># =&gt; 0 (matches at the first character)</span>
<span class="s2">&quot;I believe&quot;</span>  <span class="o">=~</span> <span class="sr">/lie/</span>                     <span class="c1"># =&gt; 4 (matches at the 5th character)</span>
<span class="s2">&quot;I am human&quot;</span> <span class="o">=~</span> <span class="sr">/bacon/</span>                   <span class="c1"># =&gt; nil (no match - bacon comes from pigs)</span>
<span class="s2">&quot;I am human&quot;</span> <span class="o">!~</span> <span class="sr">/bacon/</span>                   <span class="c1"># =&gt; true (correct, no bacon here)</span>
<span class="sr">/give me a ([0-9]+)/</span> <span class="o">=~</span> <span class="s2">&quot;give me a 7&quot;</span>     <span class="c1"># =&gt; 0 (matched)</span>
</pre></div>
</div>
<p>Use conditions! For example, an <tt class="docutils literal"><span class="pre">if</span></tt> statement</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="k">if</span> <span class="kp">false</span>
  <span class="c1"># this won&#39;t happen</span>
<span class="k">elsif</span> <span class="kp">nil</span>
  <span class="c1"># this won&#39;t either</span>
<span class="k">else</span>
  <span class="c1"># code here will run though</span>
<span class="k">end</span>
</pre></div>
</div>
<p>or a <tt class="docutils literal"><span class="pre">case</span></tt> statement:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;dog&quot;</span>
<span class="k">case</span> <span class="n">x</span>
<span class="k">when</span> <span class="s2">&quot;fish&quot;</span>
 <span class="c1"># this won&#39;t happen</span>
<span class="k">when</span> <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;monkey&quot;</span>
  <span class="c1"># this will run</span>
<span class="k">else</span>
  <span class="c1"># the else is an optional catch-all</span>
<span class="k">end</span>
</pre></div>
</div>
<p>Define a method (or a function, if you like):</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="k">def</span> <span class="nf">do_something_useless</span><span class="p">(</span> <span class="n">first_argument</span><span class="p">,</span> <span class="n">second_argument</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="s2">&quot;You gave me </span><span class="si">#{</span><span class="n">first_argument</span><span class="si">}</span><span class="s2"> and </span><span class="si">#{</span><span class="n">second_argument</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">end</span>

<span class="n">do_something_useless</span><span class="p">(</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">)</span>
<span class="c1"># =&gt; &quot;You gave me apple and banana&quot;</span>
<span class="n">do_something_useless</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="c1"># =&gt; &quot;You gave me 1 and 2&quot;</span>
<span class="c1"># see how the parens are optional if there&#39;s no confusion about what to do</span>
</pre></div>
</div>
<p>Call a method on something with <tt class="docutils literal"><span class="pre">.method_name()</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;My String&quot;</span>
<span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>            <span class="c1"># =&gt; [&quot;My&quot;, &quot;String&quot;]</span>
<span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)</span> <span class="c1"># =&gt; &quot;My, String&quot;</span>
</pre></div>
</div>
<p>To learn more about Ruby, see the following:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.ruby-lang.org/en/documentation/">http://www.ruby-lang.org/en/documentation/</a></li>
<li><a class="reference external" href="http://blog.loftninjas.org/2011/02/16/the-power-of-chef-and-ruby/">http://blog.loftninjas.org/2011/02/16/the-power-of-chef-and-ruby/</a></li>
<li><a class="reference external" href="http://www.codecademy.com/tracks/ruby">http://www.codecademy.com/tracks/ruby</a></li>
<li><a class="reference external" href="http://www.rubycentral.com/book/">http://www.rubycentral.com/book/</a></li>
<li><a class="reference external" href="http://www.ruby-doc.org/stdlib/">http://www.ruby-doc.org/stdlib/</a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="chef_overview_cookbooks.html" title="Cookbooks"
             >next</a></li>
        <li class="right" >
          <a href="breaking_changes_chef_11.html" title="What’s New in Chef 11"
             >previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>
 
      </ul>
    </div>

    <div class="footer">
    This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>


    <div class="footer">
        &copy; Copyright This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>

<!-- Start of Async Google Analytics Code -->
<script type="text/javascript">
var _gaq = _gaq || [];
var pluginUrl = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.') + 'google-analytics.com/plugins/ga/inpage_linkid.js';
_gaq.push(['_setAccount', 'UA-6369228-7']);
_gaq.push(['_setDomainName', '.opscode.com']);
_gaq.push(['_setAllowHash', false]);
_gaq.push(['_setAllowLinker', true]);
_gaq.push(['_addIgnoredRef','opscode.com']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript';
  ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(ga, s); })();
</script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Async HubSpot Analytics Code -->
<script type="text/javascript">
(function(d,s,i,r) {
            if (d.getElementById(i)){return;}
            var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
            n.id=i;n.src='//js.hubspot.com/analytics/'+(Math.ceil(new Date()/r)*r)+'/57718.js';
            e.parentNode.insertBefore(n, e);
        })(document,"script","hs-analytics",300000);
    </script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Contact Analytics Code -->
<script type="text/javascript">
(function() {
  var didInit = false;
  function initMunchkin() {
    if(didInit === false) {
      didInit = true;
      Munchkin.init('255-VFB-268');
    }
  }
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
  s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
      initMunchkin();
    }
  };
  s.onload = initMunchkin;
  document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
<!-- End of Contact Analytics Code -->


  </body>
</html>