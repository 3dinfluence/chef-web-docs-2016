

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Directory Structure &mdash; Chef Docs</title>
    
    <link rel="stylesheet" href="_static/opscode.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.1-1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/opscode.ico"/>
    <link rel="top" title="Chef Docs" href="index.html" />
    <link rel="up" title="About the Repository" href="essentials_repository.html" />
    <link rel="next" title="chefignore Files" href="essentials_repository_structure_chefignore.html" />
    <link rel="prev" title="About the Repository" href="essentials_repository.html" /> 
  </head>
  <body>
<div style="background-color: #212c35; text-align: left; padding: 0px 0px 0px 0px">
<a href="http://docs.opscode.com/"><img src="_static/opscode_html_logo.png" border="0" alt="Opscode"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="essentials_repository_structure_chefignore.html" title="chefignore Files"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="essentials_repository.html" title="About the Repository"
             accesskey="P">previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>

          <li><a href="essentials_repository.html" accesskey="U">About the Repository</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/opscode_chef_html_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Directory Structure</a><ul>
<li><a class="reference internal" href="#certificates">certificates/</a></li>
<li><a class="reference internal" href="#chef">.chef/</a></li>
<li><a class="reference internal" href="#config">config/</a><ul>
<li><a class="reference internal" href="#rake-rb">rake.rb</a></li>
<li><a class="reference internal" href="#knife-rb">knife.rb</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cookbooks">cookbooks/</a></li>
<li><a class="reference internal" href="#data-bags">data_bags/</a></li>
<li><a class="reference internal" href="#environments">environments/</a></li>
<li><a class="reference internal" href="#roles">roles/</a></li>
</ul>
</li>
</ul>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="directory-structure">
<h1>Directory Structure<a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h1>
<p>The chef-repo contains several directories, each with a README file that describes what it is for and how to use that directory when managing systems with Chef.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This document describes the default directory that is present in most Chef repositories.</p>
</div>
<p>The sub-directories in the Chef repository are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">certificates/</span></tt></li>
<li><tt class="docutils literal"><span class="pre">.chef/</span></tt></li>
<li><tt class="docutils literal"><span class="pre">config/</span></tt></li>
<li><tt class="docutils literal"><span class="pre">cookbooks/</span></tt></li>
<li><tt class="docutils literal"><span class="pre">data_bags/</span></tt></li>
<li><tt class="docutils literal"><span class="pre">environments/</span></tt></li>
<li><tt class="docutils literal"><span class="pre">roles/</span></tt></li>
</ul>
<div class="section" id="certificates">
<h2>certificates/<a class="headerlink" href="#certificates" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">certificates/</span></tt> directory is used to store the SSL certificates that are generated by the Rake task <tt class="docutils literal"><span class="pre">ssl_cert</span></tt>. The values that are used in the SSL certificates can be modified in the config/rake.rb file.</p>
<p>To generate a certificate for a monitoring server:</p>
<ol class="arabic">
<li><p class="first">Run the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>rake ssl_cert <span class="nv">FQDN</span><span class="o">=</span>monitoring.example.com
</pre></div>
</div>
</li>
<li><p class="first">Once the certificates are generated, copy them into each cookbook that will use them. For example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>cp certificates/monitoring.example.com* cookbooks/COOKBOOK_NAME/files/default
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">COOKBOOK_NAME</span></tt> is the name of the cookbook that will use the certificate.</p>
</li>
<li><p class="first">And then in the recipe for each cookbook, create a <tt class="docutils literal"><span class="pre">cookbook_file</span></tt> resource to configure a resource that puts them in place on the destination server:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">cookbook_file</span> <span class="s1">&#39;/etc/apache2/ssl/monitoring.example.com.pem&#39;</span>
  <span class="nx">owner</span> <span class="s1">&#39;root&#39;</span>
  <span class="nx">group</span> <span class="s1">&#39;root&#39;</span>
  <span class="nx">mode</span> <span class="mi">0600</span>
<span class="nx">end</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="chef">
<h2>.chef/<a class="headerlink" href="#chef" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">.chef/</span></tt> directory is a hidden directory that is used to store .pem validation that are provided by the Chef Server and a knife.rb file. These files are required for interaction with a Chef Server.</p>
</div>
<div class="section" id="config">
<h2>config/<a class="headerlink" href="#config" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">config/</span></tt> directory is used to store the <tt class="docutils literal"><span class="pre">rake.rb</span></tt> file, which is the configuration file for Rake. Rake is a Ruby application (and a third-party build management tool) that is used by Chef to help manage the installation of various components, including Chef itself, cookbooks, and so on.</p>
<p>The Chef repository uses two configuration files: <tt class="docutils literal"><span class="pre">rake.rb</span></tt> (required) and <tt class="docutils literal"><span class="pre">knife.rb</span></tt> (optional).</p>
<div class="section" id="rake-rb">
<h3>rake.rb<a class="headerlink" href="#rake-rb" title="Permalink to this headline">¶</a></h3>
<p>The rake.rb file is used to store the configuration details used by Rake, which is a third-party build management tool that is used by Chef to help manage the installation of various components. The config/rake.rb file is also used to generate SSL certificates based on the configuration settings for SSL certificates and the Rake task <tt class="docutils literal"><span class="pre">ssl_cert</span></tt>.</p>
<p>Rake includes tasks that are installed with the Chef libraries. To view the tasks that are available, run <tt class="docutils literal"><span class="pre">rake</span> <span class="pre">-T</span></tt>. For more information about Rake, see <a class="reference external" href="http://en.wikipedia.org/wiki/Rake_(software">http://en.wikipedia.org/wiki/Rake_(software</a>).</p>
<p>The following Rake commands are not replaced by Knife sub-commands:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">bundle_cookbook</span></tt></td>
<td>Creates cookbook tar.gz files in the pkgs/ directory.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">install</span></tt></td>
<td>Calls the following Rake commands: <tt class="docutils literal"><span class="pre">update</span></tt>, <tt class="docutils literal"><span class="pre">roles</span></tt>, and <tt class="docutils literal"><span class="pre">upload_cookbooks</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">ssl_cert</span></tt></td>
<td>Creates self-signed SSL certificates in the <tt class="docutils literal"><span class="pre">certificates/</span></tt> directory.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">update</span></tt></td>
<td>Updates the repository from version control server; understands git and Subversion.</td>
</tr>
</tbody>
</table>
<p>The following Rake commands duplicate functionality in Chef and may be removed from future updates to the Chef libraries:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">metadata</span></tt></td>
<td>Replaced by: <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">cookbook</span> <span class="pre">metadata</span> <span class="pre">-a</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">new_cookbook</span></tt></td>
<td>Replaced by: <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">cookbook</span> <span class="pre">create</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">role</span></tt></td>
<td>Replaced by: <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">role</span> <span class="pre">from</span> <span class="pre">file</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">roles</span></tt></td>
<td>Replaced by: <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">role</span> <span class="pre">from</span> <span class="pre">file</span></tt>; iterates over roles and then uploads them.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">test_cookbooks</span></tt></td>
<td>Replaced by: <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">cookbook</span> <span class="pre">test</span> <span class="pre">-a</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">test_cookbook</span></tt></td>
<td>Replaced by: <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">cookbook</span> <span class="pre">test</span> <span class="pre">COOKBOOK_NAME</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">upload_cookbooks</span></tt></td>
<td>Replaced by: <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">cookbook</span> <span class="pre">upload</span> <span class="pre">-a</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">upload_cookbook</span></tt></td>
<td>Replaced by: <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">cookbook</span> <span class="pre">upload</span> <span class="pre">COOKBOOK_NAME</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="knife-rb">
<h3>knife.rb<a class="headerlink" href="#knife-rb" title="Permalink to this headline">¶</a></h3>
<p>A knife.rb file is used to specify the repository-specific configuration details for Knife. This file is the default configuration file and is loaded every time this executable is run. The Knife executable cannot be run as a daemon. The configuration file is located at: ~/.chef/knife.rb. If a knife.rb file is present in the .chef/knife.rb directory in the Chef repository, the settings contained within that file will override the default configuration settings.</p>
</div>
</div>
<div class="section" id="cookbooks">
<h2>cookbooks/<a class="headerlink" href="#cookbooks" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">cookbooks/</span></tt> directory is used to store the cookbooks that are used by Chef when configuring the various systems in the organization. This directory contains the cookbooks that are used to configure systems in the infrastructure with Chef. Each cookbook can be configured to contain cookbook-specific copyright, email, and license data.</p>
</div>
<div class="section" id="data-bags">
<h2>data_bags/<a class="headerlink" href="#data-bags" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">data_bags/</span></tt> directory is used to store all of the data bags that exist for a Chef organization. Each sub-directory corresponds to a single data bag on the Chef Server and contains a JSON file for each data bag item. If a sub-directory does not exist, then create it using SSL commands. After a data bag item is created, it can then be uploaded to the Chef Server.</p>
</div>
<div class="section" id="environments">
<h2>environments/<a class="headerlink" href="#environments" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">environments/</span></tt> directory is used to store the files that define the environments that are available to the Chef Server. The environments files can be Ruby DSL files (.rb) or they can be JSON files (.json). Use Knife to install environment files to the Chef Server.</p>
</div>
<div class="section" id="roles">
<h2>roles/<a class="headerlink" href="#roles" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">roles/</span></tt> directory is used to store the files that define the roles that are available to the Chef Server. The roles files can be Ruby DSL files (.rb) or they can be JSON files (.json). Use Knife to install role files to the Chef Server.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="essentials_repository_structure_chefignore.html" title="chefignore Files"
             >next</a></li>
        <li class="right" >
          <a href="essentials_repository.html" title="About the Repository"
             >previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>

          <li><a href="essentials_repository.html" >About the Repository</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
    This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>


    <div class="footer">
        &copy; Copyright This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>

<!-- Start of Async Google Analytics Code -->
<script type="text/javascript">
var _gaq = _gaq || [];
var pluginUrl = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.') + 'google-analytics.com/plugins/ga/inpage_linkid.js';
_gaq.push(['_setAccount', 'UA-6369228-7']);
_gaq.push(['_setDomainName', '.opscode.com']);
_gaq.push(['_setAllowHash', false]);
_gaq.push(['_setAllowLinker', true]);
_gaq.push(['_addIgnoredRef','opscode.com']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript';
  ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(ga, s); })();
</script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Async HubSpot Analytics Code -->
<script type="text/javascript">
(function(d,s,i,r) {
            if (d.getElementById(i)){return;}
            var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
            n.id=i;n.src='//js.hubspot.com/analytics/'+(Math.ceil(new Date()/r)*r)+'/57718.js';
            e.parentNode.insertBefore(n, e);
        })(document,"script","hs-analytics",300000);
    </script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Contact Analytics Code -->
<script type="text/javascript">
(function() {
  var didInit = false;
  function initMunchkin() {
    if(didInit === false) {
      didInit = true;
      Munchkin.init('255-VFB-268');
    }
  }
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
  s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
      initMunchkin();
    }
  };
  s.onload = initMunchkin;
  document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
<!-- End of Contact Analytics Code -->


  </body>
</html>