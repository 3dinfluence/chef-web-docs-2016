

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>About Ohai &mdash; Chef Docs</title>
    
    <link rel="stylesheet" href="_static/opscode.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.1-1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/opscode.ico"/>
    <link rel="top" title="Chef Docs" href="index.html" />
    <link rel="next" title="orgmapper" href="orgmapper.html" />
    <link rel="prev" title="value_for_platform_family Method" href="dsl_recipe_method_value_for_platform_family.html" /> 
  </head>
  <body>
<div style="background-color: #212c35; text-align: left; padding: 0px 0px 0px 0px">
<a href="http://docs.opscode.com/"><img src="_static/opscode_html_logo.png" border="0" alt="Opscode"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="orgmapper.html" title="orgmapper"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="dsl_recipe_method_value_for_platform_family.html" title="value_for_platform_family Method"
             accesskey="P">previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/opscode_chef_html_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">About Ohai</a><ul>
<li><a class="reference internal" href="#automatic-attributes">Automatic Attributes</a><ul>
<li><a class="reference internal" href="#attribute-persistence">Attribute Persistence</a></li>
<li><a class="reference internal" href="#attribute-precedence">Attribute Precedence</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install-ohai">Install Ohai</a><ul>
<li><a class="reference internal" href="#install-from-github">Install from Github</a></li>
<li><a class="reference internal" href="#install-from-rubygems">Install from RubyGems</a></li>
<li><a class="reference internal" href="#install-on-microsoft-windows">Install on Microsoft Windows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#create-ohai-plugins">Create Ohai Plugins</a><ul>
<li><a class="reference internal" href="#create-a-simple-plugin">Create a Simple Plugin</a></li>
<li><a class="reference internal" href="#load-a-plugin">Load a Plugin</a></li>
<li><a class="reference internal" href="#use-a-mash">Use a Mash</a></li>
<li><a class="reference internal" href="#work-with-platforms">Work with Platforms</a></li>
<li><a class="reference internal" href="#extend-a-plugin">Extend a Plugin</a></li>
<li><a class="reference internal" href="#use-the-ohai-cookbook">Use the Ohai Cookbook</a></li>
<li><a class="reference internal" href="#change-default-location">Change Default Location</a></li>
<li><a class="reference internal" href="#upload-a-custom-plugin">Upload a Custom Plugin</a></li>
<li><a class="reference internal" href="#use-the-ohai-recipe">Use the ohai Recipe</a></li>
</ul>
</li>
<li><a class="reference internal" href="#disable-a-plugin">Disable a Plugin</a></li>
<li><a class="reference internal" href="#community-ohai-plugins">Community Ohai Plugins</a></li>
</ul>
</li>
</ul>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="about-ohai">
<h1>About Ohai<a class="headerlink" href="#about-ohai" title="Permalink to this headline">¶</a></h1>
<p>Ohai is a tool that is used to detect certain properties about a node&#8217;s environment and provide them to the chef-client during every Chef run. The types of properties Ohai reports on include:</p>
<ul class="simple">
<li>Platform details</li>
<li>Networking usage</li>
<li>Memory usage</li>
<li>Processor usage</li>
<li>Kernel data</li>
<li>Host names</li>
<li>Fully qualified domain names</li>
<li>Other configuration details</li>
</ul>
<p>When Chef configures the node object during each Chef run, these attributes are used by the chef-client to ensure that certain properties remain unchanged. (These properties are also referred to as <tt class="docutils literal"><span class="pre">automatic</span></tt> attributes.) Ohai is part of the required configuration on each node that is registered with the Chef Server.</p>
<div class="section" id="automatic-attributes">
<h2>Automatic Attributes<a class="headerlink" href="#automatic-attributes" title="Permalink to this headline">¶</a></h2>
<p>An automatic attribute is a specific detail about a node, such as an IP address, a host name, a list of loaded kernel modules, and so on. Automatic attributes are detected by Ohai and are then used by Chef to ensure that these attribute are handled properly during every Chef run. The most commonly accessed automatic attributes are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node['platform']</span></tt></td>
<td>The platform on which a node is running. This attribute helps determine which providers will be used.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">node['platform_version']</span></tt></td>
<td>The version of the platform. This attribute helps determine which providers will be used.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node['ipaddress']</span></tt></td>
<td>The IP address for a node. If the node has a default route, this is the IPV4 address for the interface. If the node does not have a default route, the value for this attribute should be <tt class="docutils literal"><span class="pre">nil</span></tt>. The IP address for default route is the recommended default value.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">node['macaddress']</span></tt></td>
<td>The MAC address for a node, determined by the same interface that detects the <tt class="docutils literal"><span class="pre">node['ipaddress']</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node['fqdn']</span></tt></td>
<td>The fully qualified domain name for a node. This is used as the name of a node unless otherwise set.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">node['hostname']</span></tt></td>
<td>The host name for the node.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node['domain']</span></tt></td>
<td>The domain for the node.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">node['recipes']</span></tt></td>
<td>A list of recipes associated with a node (and part of that node&#8217;s run-list).</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">node['roles']</span></tt></td>
<td>A list of roles associated with a node (and part of that node&#8217;s run-list).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">node['ohai_time']</span></tt></td>
<td>The time at which Ohai was last run. This attribute is not commonly used in recipes, but it is saved to the Chef Server and can be accessed using the <tt class="docutils literal"><span class="pre">knife</span> <span class="pre">status</span></tt> sub-command.</td>
</tr>
</tbody>
</table>
<p><strong>Get a list of automatic attributes for a node</strong>
.. include:: ../../includes_ohai/includes_ohai_attribute_list.rst</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Attributes can be configured in cookbooks (attribute files and recipes), roles, and environments. In addition, Ohai collects attribute data about each node at the start of the Chef run. See the <a class="reference internal" href="chef_overview_attributes.html"><em>overview of attributes</em></a> for more information about how all of these attributes fit together.</p>
</div>
<div class="section" id="attribute-persistence">
<h3>Attribute Persistence<a class="headerlink" href="#attribute-persistence" title="Permalink to this headline">¶</a></h3>
<p>At the beginning of a Chef run, all default, override, and automatic attributes are reset. Chef rebuilds them using data collected by Ohai at the beginning of the Chef run and by attributes that are defined in cookbooks, roles, and environments. Normal attributes are never reset. All attributes are then merged and applied to the node according to attribute precedence. At the conclusion of the Chef run, all default, override, and automatic attributes disappear, leaving only a collection of normal attributes that will persist until the next Chef run.</p>
</div>
<div class="section" id="attribute-precedence">
<h3>Attribute Precedence<a class="headerlink" href="#attribute-precedence" title="Permalink to this headline">¶</a></h3>
<p>Attributes are always applied to Chef in the following order:</p>
<ol class="arabic simple">
<li>A <tt class="docutils literal"><span class="pre">default</span></tt> attribute located in an attribute file</li>
<li>A <tt class="docutils literal"><span class="pre">default</span></tt> attribute located in a recipe</li>
<li>A <tt class="docutils literal"><span class="pre">default</span></tt> attribute located in an environment</li>
<li>A <tt class="docutils literal"><span class="pre">default</span></tt> attribute located in role</li>
<li>A <tt class="docutils literal"><span class="pre">force_default</span></tt> attribute located in an attribute file</li>
<li>A <tt class="docutils literal"><span class="pre">force_default</span></tt> attribute located in a recipe</li>
<li>A <tt class="docutils literal"><span class="pre">normal</span></tt> attribute located in an attribute file</li>
<li>A <tt class="docutils literal"><span class="pre">normal</span></tt> attribute located in a recipe</li>
<li>An <tt class="docutils literal"><span class="pre">override</span></tt> attribute located in an attribute file</li>
<li>An <tt class="docutils literal"><span class="pre">override</span></tt> attribute located in a recipe</li>
<li>An <tt class="docutils literal"><span class="pre">override</span></tt> attribute located in a role</li>
<li>An <tt class="docutils literal"><span class="pre">override</span></tt> attribute located in an environment</li>
<li>A <tt class="docutils literal"><span class="pre">force_override</span></tt> attribute located in an attribute file</li>
<li>A <tt class="docutils literal"><span class="pre">force_override</span></tt> attribute located in a recipe</li>
<li>An <tt class="docutils literal"><span class="pre">automatic</span></tt> attribute identified by Ohai at the start of the Chef run</li>
</ol>
<p>where the last attribute in the list is the one that is applied to the node.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The attribute precedence order for roles and environments is reversed for <tt class="docutils literal"><span class="pre">default</span></tt> and <tt class="docutils literal"><span class="pre">override</span></tt> attributes. The precedence order for <tt class="docutils literal"><span class="pre">default</span></tt> attributes is environment, then role. The precedence order for <tt class="docutils literal"><span class="pre">override</span></tt> attributes is role, then environment. Applying environment <tt class="docutils literal"><span class="pre">override</span></tt> attributes after role <tt class="docutils literal"><span class="pre">override</span></tt> attributes allows a role to exist in multiple environments.</p>
</div>
<p>Attribute precedence, viewed from the same perspective as the Chef overview diagram, where the numbers in the diagram match the order of attribute precedence:</p>
<img alt="_images/overview_chef_attributes_precedence.png" src="_images/overview_chef_attributes_precedence.png" />
<p>Attribute precedence, when viewed as a table:</p>
<img alt="_images/overview_chef_attributes_table.png" src="_images/overview_chef_attributes_table.png" />
</div>
</div>
<div class="section" id="install-ohai">
<h2>Install Ohai<a class="headerlink" href="#install-ohai" title="Permalink to this headline">¶</a></h2>
<p>Ohai is a requirement for Chef and is installed whenever (and wherever) Chef is installed. Ohai can also be installed separately from Chef.</p>
<div class="section" id="install-from-github">
<h3>Install from Github<a class="headerlink" href="#install-from-github" title="Permalink to this headline">¶</a></h3>
<p>To install Ohai from git, run the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>clone git repository
</pre></div>
</div>
<p>or install from RubyGems with Rake:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>rake install
</pre></div>
</div>
</div>
<div class="section" id="install-from-rubygems">
<h3>Install from RubyGems<a class="headerlink" href="#install-from-rubygems" title="Permalink to this headline">¶</a></h3>
<p>To install Ohai from RubyGems, do the following:</p>
<ol class="arabic">
<li><p class="first">Add the gem server to the local resources:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo gem <span class="nb">source</span> -a http://rubygems.org
</pre></div>
</div>
</li>
<li><p class="first">Install Ohai:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>sudo gem install ohai
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="install-on-microsoft-windows">
<h3>Install on Microsoft Windows<a class="headerlink" href="#install-on-microsoft-windows" title="Permalink to this headline">¶</a></h3>
<p>Ohai (version 0.6.x or higher) can be run on the following versions of Microsoft Windows:</p>
<ul class="simple">
<li>Windows 7 Ultimate RC1</li>
<li>Windows 7 Enterprise</li>
<li>Windows XP Professional</li>
<li>Windows Vista Ultimate</li>
<li>Windows 2000 Server SP4</li>
<li>Windows 2003 Server R2 Standard</li>
<li>Windows 2008 Server R2 Standard</li>
</ul>
<p>To install Ohai on Microsoft Windows, do the following:</p>
<ol class="arabic">
<li><p class="first">Install Ruby using the one-click installer: <a class="reference external" href="http://rubyforge.org/frs/download.php/69034/rubyinstaller-1.8.7-p249-rc2.exe">http://rubyforge.org/frs/download.php/69034/rubyinstaller-1.8.7-p249-rc2.exe</a>.</p>
</li>
<li><p class="first">Install Ohai and WMI bindings:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>C:<span class="se">\R</span>uby&gt;gem install ohai ruby-wmi
</pre></div>
</div>
</li>
<li><p class="first">Run Ohai:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>C:<span class="se">\R</span>uby&gt;ohai
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="create-ohai-plugins">
<h2>Create Ohai Plugins<a class="headerlink" href="#create-ohai-plugins" title="Permalink to this headline">¶</a></h2>
<p>Ohai is a requirement for Chef and is installed whenever (and wherever) Chef is installed. Ohai can also be installed separately from Chef.</p>
<div class="section" id="create-a-simple-plugin">
<h3>Create a Simple Plugin<a class="headerlink" href="#create-a-simple-plugin" title="Permalink to this headline">¶</a></h3>
<p>When additional data about a system infrastructure is required, a custom Ohai plugin can be used to gather that information. An Ohai plugin is a Ruby DSL. For example, the following is about as simple as it gets:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">provides</span> <span class="s2">&quot;orly&quot;</span>
<span class="n">orly</span> <span class="s2">&quot;yeah, rly.&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="load-a-plugin">
<h3>Load a Plugin<a class="headerlink" href="#load-a-plugin" title="Permalink to this headline">¶</a></h3>
<p>To load a plugin, create a &#8220;plugins&#8221; folder and put the above code in the <tt class="docutils literal"><span class="pre">plugins/orly.rb</span></tt> file.</p>
<p>Now to fire up irb (and assuming the directory &#8220;plugins&#8221; is the current folder; if not adjust your path):</p>
<div class="highlight-bash"><div class="highlight"><pre>&gt;&gt; require <span class="s1">&#39;ohai&#39;</span>
&gt;&gt; Ohai::Config<span class="o">[</span>:plugin_path<span class="o">]</span> &lt;&lt; <span class="s1">&#39;./plugins&#39;</span>
&gt;&gt; <span class="nv">o</span> <span class="o">=</span> Ohai::System.new
&gt;&gt; o.all_plugins
&gt;&gt; o.orly <span class="c">#=&gt; &quot;yea, rly&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="use-a-mash">
<h3>Use a Mash<a class="headerlink" href="#use-a-mash" title="Permalink to this headline">¶</a></h3>
<p>Most of the information we want to lookup would be nested in some way, and Ohai tends to do this by storing the data in a Mash. This can be done by creating a new mash and setting the attribute to it.</p>
<p>In plugins/canhas.rb:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">provides</span> <span class="s2">&quot;canhas&quot;</span>
<span class="n">canhas</span> <span class="no">Mash</span><span class="o">.</span><span class="n">new</span>
<span class="n">canhas</span><span class="o">[</span><span class="ss">:burger</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;want&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="work-with-platforms">
<h3>Work with Platforms<a class="headerlink" href="#work-with-platforms" title="Permalink to this headline">¶</a></h3>
<p>One of the main reasons for using Ohai is to gather information regardless of the operating system. Luckily this is made easy by optionally loading recipes based on the platform. With that platform specific calls abstracted away you can keep your code DRY.</p>
<p>The builtin plugins that come with Ohai use the following trick to load platform specific code. It works by creating a base cross-platform plugin that loads the platform specific plugin from a subdirectory. In plugins/lolcode.rb:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">provides</span> <span class="s2">&quot;languages/lolcode&quot;</span>
<span class="n">require_plugin</span> <span class="s2">&quot;languages&quot;</span>
<span class="n">require_plugin</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">os</span><span class="si">}</span><span class="s2">::lolcode&quot;</span>

<span class="n">languages</span><span class="o">[</span><span class="ss">:lolcode</span><span class="o">]</span> <span class="o">=</span> <span class="no">Mash</span><span class="o">.</span><span class="n">new</span> <span class="k">unless</span> <span class="n">languages</span><span class="o">[</span><span class="ss">:lolcode</span><span class="o">]</span>
<span class="n">languages</span><span class="o">[</span><span class="ss">:lolcode</span><span class="o">][</span><span class="ss">:version</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;TEH VERSHIONS&quot;</span>
</pre></div>
</div>
<p>In plugins/darwin/lolcode.rb:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">provides</span> <span class="s2">&quot;languages/lolcode&quot;</span>
<span class="n">require_plugin</span> <span class="s2">&quot;languages&quot;</span>
<span class="n">languages</span><span class="o">[</span><span class="ss">:lolcode</span><span class="o">]</span> <span class="o">=</span> <span class="no">Mash</span><span class="o">.</span><span class="n">new</span> <span class="k">unless</span> <span class="n">languages</span><span class="o">[</span><span class="ss">:lolcode</span><span class="o">]</span>
<span class="n">languages</span><span class="o">[</span><span class="ss">:lolcode</span><span class="o">][</span><span class="ss">:platform</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;MACKERS&quot;</span>
</pre></div>
</div>
<p>Checkout ohai&#8217;s os.rb for the list of platform names.</p>
<p>All of these examples can be found in the <tt class="docutils literal"><span class="pre">ohai-plugin-howto</span></tt> github repo, you should be able to clone that and run the ruby scripts in the repo&#8217;s root directory. If you figure out any other handy tricks please fork the project and add them.</p>
</div>
<div class="section" id="extend-a-plugin">
<h3>Extend a Plugin<a class="headerlink" href="#extend-a-plugin" title="Permalink to this headline">¶</a></h3>
<p>Ohai makes it very easy to extend a current plugin with new information. Simply require the plugin you want to extend and extend away. In this example we want to add LOLCODE to languages.</p>
<p>In plugins/lolcode.rb:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">provides</span> <span class="s2">&quot;languages/lolcode&quot;</span>
<span class="n">require_plugin</span> <span class="s2">&quot;languages&quot;</span>
<span class="n">languages</span><span class="o">[</span><span class="ss">:lolcode</span><span class="o">]</span> <span class="o">=</span> <span class="no">Mash</span><span class="o">.</span><span class="n">new</span>
<span class="n">languages</span><span class="o">[</span><span class="ss">:lolcode</span><span class="o">][</span><span class="ss">:version</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;TEH VERSHIONS&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="use-the-ohai-cookbook">
<h3>Use the Ohai Cookbook<a class="headerlink" href="#use-the-ohai-cookbook" title="Permalink to this headline">¶</a></h3>
<p>To download the <tt class="docutils literal"><span class="pre">ohai</span></tt> cookbook to the Chef repository:</p>
<ol class="arabic">
<li><p class="first">Run the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>knife cookbook site install ohai
</pre></div>
</div>
</li>
<li><p class="first">Knife will return something like the following:</p>
</li>
</ol>
<div class="highlight-bash"><div class="highlight"><pre>INFO: Downloading ohai from the cookbooks site at version 0.9.0
INFO: Cookbook saved: /Users/jtimberman/chef-repo/cookbooks/ohai.tar.gz
INFO: Checking out the master branch.
INFO: Checking the status of the vendor branch.
INFO: Creating vendor branch.
INFO: Removing pre-existing version.
INFO: Uncompressing ohai version 0.9.0.
INFO: Adding changes.
INFO: Committing changes.
INFO: Creating tag chef-vendor-ohai-0.9.0.
INFO: Checking out the master branch.
INFO: Merging changes from ohai version 0.9.0.
<span class="o">[</span> ... SNIP ... <span class="o">]</span>
INFO: Cookbook ohai version 0.9.0 successfully vendored!
</pre></div>
</div>
</div>
<div class="section" id="change-default-location">
<h3>Change Default Location<a class="headerlink" href="#change-default-location" title="Permalink to this headline">¶</a></h3>
<p>To change the directory in which plugins are located edit the cookbook attributes file and change the path for the <tt class="docutils literal"><span class="pre">node[:ohai][:plugin_path]</span></tt> attribute. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">default</span><span class="o">[</span><span class="ss">:ohai</span><span class="o">][</span><span class="ss">:plugin_path</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;/etc/chef/ohai_plugins&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="upload-a-custom-plugin">
<h3>Upload a Custom Plugin<a class="headerlink" href="#upload-a-custom-plugin" title="Permalink to this headline">¶</a></h3>
<p>To upload the Ohai cookbook to the Chef Server, use Knife and run the following:</p>
<div class="highlight-bash"><div class="highlight"><pre>knife cookbook upload ohai
</pre></div>
</div>
<p>to return something similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre>INFO: Saving ohai
INFO: Validating ruby files
INFO: Validating templates
INFO: Syntax OK
INFO: Generating Metadata
INFO: Uploading files
<span class="o">[</span> ... SNIP ... <span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="use-the-ohai-recipe">
<h3>Use the ohai Recipe<a class="headerlink" href="#use-the-ohai-recipe" title="Permalink to this headline">¶</a></h3>
<p>To upload the Ohai cookbook to the Chef Server, use Knife and run the following:</p>
<div class="highlight-bash"><div class="highlight"><pre>knife cookbook upload ohai
</pre></div>
</div>
<p>to return something similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre>INFO: Saving ohai
INFO: Validating ruby files
INFO: Validating templates
INFO: Syntax OK
INFO: Generating Metadata
INFO: Uploading files
<span class="o">[</span> ... SNIP ... <span class="o">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="disable-a-plugin">
<h2>Disable a Plugin<a class="headerlink" href="#disable-a-plugin" title="Permalink to this headline">¶</a></h2>
<p>To disable an Ohai plugin, add the following code to the client.rb file:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="no">Ohai</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:disabled_plugins</span><span class="o">]</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;plugin_name&quot;</span><span class="p">,</span> <span class="s2">&quot;plugin_name&quot;</span><span class="o">]</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">plugin_name</span></tt> is a comma-delimited list of Ohai plugins. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="no">Ohai</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:disabled_plugins</span><span class="o">]</span> <span class="o">=</span> <span class="o">[</span><span class="s2">&quot;passwd&quot;</span><span class="p">,</span> <span class="s2">&quot;rackspace&quot;</span><span class="p">,</span> <span class="s2">&quot;dmi&quot;</span><span class="p">,</span> <span class="s2">&quot;dmi_common&quot;</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="community-ohai-plugins">
<h2>Community Ohai Plugins<a class="headerlink" href="#community-ohai-plugins" title="Permalink to this headline">¶</a></h2>
<p>The following Ohai plugins are available in the Chef open source community:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Plugin</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference external" href="https://github.com/demonccc/chef-repo/blob/master/plugins/ohai/dell.rb">dell.rb</a></td>
<td>Adds some useful Dell server information to Ohai. For example: service tag, express service code, storage info, RAC info, and so on. To use this plugin, OMSA and SMBIOS applications need to be installed.</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://github.com/demonccc/chef-repo/blob/master/plugins/ohai/linux/dpkg.rb">dpkg.rb</a></td>
<td>Adds dpkg info to Ohai. This collections information about the status of Debian packages and about the various packages that are installed.</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://bitbucket.org/retr0h/ohai">ipmi.rb</a></td>
<td>Adds an IPMI mac and IP address to Ohai, where available.</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://github.com/albertsj1/ohai-plugins/blob/master/kvm_extensions.rb">kvm_extensions.rb</a></td>
<td>Adds extensions for virtualization attributes to provide additional host and guest information for KVM.</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://github.com/demonccc/chef-repo/blob/master/plugins/ohai/linux/ladvd.rb">ladvd.rb</a></td>
<td>Adds ladvd information to Ohai, when it exists.</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://github.com/jespada/ohai-plugins/blob/master/lxc_virtualization.rb">lxc_virtualization.rb</a></td>
<td>Adds extensions for virtualization attributes to provide host and guest information for Linux containers.</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://gist.github.com/1040543">network_addr.rb</a></td>
<td>Adds extensions for network attributes with additional <tt class="docutils literal"><span class="pre">ipaddrtype_iface</span></tt> attributes to make it semantically easier to retrieve addresses. For example: <tt class="docutils literal"><span class="pre">node['network']['ipaddress_eth0']</span></tt> versus <tt class="docutils literal"><span class="pre">node['network']['interfaces']['eth0']['addresses'].guesswhichisfirst</span></tt>.</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://github.com/agoddard/ohai-plugins/blob/master/plugins/network_ports.rb">network_ports.rb</a></td>
<td>Adds extensions for network attributes so that Ohai can detect to which interfaces TCP and UDP ports are bound.</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://github.com/sbates/Chef-odds-n-ends/blob/master/ohai/parse_host_plugin.rb">parse_host_plugin.rb</a></td>
<td>Adds the ability to parse a host name using three top-level attribute and five nested attributes.</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://github.com/stevendanna/ohai-plugins/blob/master/r.rb">r.rb</a></td>
<td>Adds the ability to collect basic information about the R Project.</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://github.com/demonccc/chef-repo/blob/master/plugins/ohai/linux/rpm.rb">rpm.rb</a></td>
<td>Adds RPM Package Manager information to Ohai and collects information about the status of RPM Package Manager packages and about the various packages that are installed.</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://github.com/spheromak/cookbooks/blob/master/ohai/files/default/sysctl.rb">sysctl.rb</a></td>
<td>Adds sysctl information to Ohai.</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://github.com/albertsj1/ohai-plugins/blob/master/vserver.rb">vserver.rb</a></td>
<td>Adds extensions for virtualization attributes to allow a Linux virtual server host and guest information to be used by Ohai.</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://github.com/cloudant/ohai_plugins/blob/master/wtf.rb">wtf.rb</a></td>
<td>Adds the irreverent wtfismyip.com service so that Ohai can determine a machine&#8217;s external IPv4 address and geographical location.</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://github.com/spheromak/cookbooks/blob/master/ohai/files/default/xenserver.rb">xenserver.rb</a></td>
<td>Adds extensions for virtualization attributes to load up Citrix XenServer host and guest information.</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://github.com/timops/ohai-plugins/blob/master/win32_software.rb">win32_software.rb</a></td>
<td>Adds the ability for Ohai to use Windows Management Instrumentation (WMI) discover useful information about software that is installed on any node that is running Microsoft Windows.</td>
</tr>
<tr class="row-even"><td><a class="reference external" href="https://github.com/timops/ohai-plugins/blob/master/win32_svc.rb">win32_svc.rb</a></td>
<td>Adds the ability for Ohai to query using Windows Management Instrumentation (WMI) to get information about all services that are registered on a node that is running Microsoft Windows.</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="orgmapper.html" title="orgmapper"
             >next</a></li>
        <li class="right" >
          <a href="dsl_recipe_method_value_for_platform_family.html" title="value_for_platform_family Method"
             >previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>
 
      </ul>
    </div>

    <div class="footer">
    This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>


    <div class="footer">
        &copy; Copyright This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>

<!-- Start of Async Google Analytics Code -->
<script type="text/javascript">
var _gaq = _gaq || [];
var pluginUrl = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.') + 'google-analytics.com/plugins/ga/inpage_linkid.js';
_gaq.push(['_setAccount', 'UA-6369228-7']);
_gaq.push(['_setDomainName', '.opscode.com']);
_gaq.push(['_setAllowHash', false]);
_gaq.push(['_setAllowLinker', true]);
_gaq.push(['_addIgnoredRef','opscode.com']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript';
  ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(ga, s); })();
</script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Async HubSpot Analytics Code -->
<script type="text/javascript">
(function(d,s,i,r) {
            if (d.getElementById(i)){return;}
            var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
            n.id=i;n.src='//js.hubspot.com/analytics/'+(Math.ceil(new Date()/r)*r)+'/57718.js';
            e.parentNode.insertBefore(n, e);
        })(document,"script","hs-analytics",300000);
    </script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Contact Analytics Code -->
<script type="text/javascript">
(function() {
  var didInit = false;
  function initMunchkin() {
    if(didInit === false) {
      didInit = true;
      Munchkin.init('255-VFB-268');
    }
  }
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
  s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
      initMunchkin();
    }
  };
  s.onload = initMunchkin;
  document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
<!-- End of Contact Analytics Code -->


  </body>
</html>