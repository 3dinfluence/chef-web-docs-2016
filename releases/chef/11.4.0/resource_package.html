

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>package &mdash; Chef Docs</title>
    
    <link rel="stylesheet" href="_static/opscode.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.1-1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/opscode.ico"/>
    <link rel="top" title="Chef Docs" href="index.html" />
    <link rel="up" title="About Resources and Providers" href="resource.html" />
    <link rel="next" title="pacman_package" href="resource_pacman_package.html" />
    <link rel="prev" title="ohai" href="resource_ohai.html" /> 
  </head>
  <body>
<div style="background-color: #212c35; text-align: left; padding: 0px 0px 0px 0px">
<a href="http://docs.opscode.com/"><img src="_static/opscode_html_logo.png" border="0" alt="Opscode"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="resource_pacman_package.html" title="pacman_package"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="resource_ohai.html" title="ohai"
             accesskey="P">previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>

          <li><a href="resource.html" accesskey="U">About Resources and Providers</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/opscode_chef_html_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">package</a><ul>
<li><a class="reference internal" href="#syntax">Syntax</a></li>
<li><a class="reference internal" href="#gem-package-options">Gem Package Options</a><ul>
<li><a class="reference internal" href="#specify-with-hash">Specify with Hash</a></li>
<li><a class="reference internal" href="#specify-with-string">Specify with String</a></li>
<li><a class="reference internal" href="#specify-with-gemrc-file">Specify with .gemrc File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#actions">Actions</a></li>
<li><a class="reference internal" href="#attributes">Attributes</a></li>
<li><a class="reference internal" href="#providers">Providers</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="package">
<h1>package<a class="headerlink" href="#package" title="Permalink to this headline">¶</a></h1>
<p>A <a class="reference external" href="http://docs.opscode.com/resource.html">resource</a> is a key part of a <a class="reference external" href="http://docs.opscode.com/essentials_cookbook_recipes.html">recipe</a> that defines the actions that can be taken against a piece of the system. These actions are identified during each <a class="reference external" href="http://docs.opscode.com/essentials_nodes_chef_run.html">Chef run</a> as the resource collection is compiled. Once identified, each resource (in turn) is mapped to a provider, which then configures each piece of the system.</p>
<p>The <strong>package</strong> resource is used to manage packages. When the package is installed from a local file (such as with RubyGems, dpkg, or RPM Package Manager), the file must be added to the node using the <strong>remote_file</strong> or <strong>cookbook_file</strong> resources.</p>
<p>This resource is the base resource for several other resources used for package management on specific platforms. While it is possible to use each of these specific resources, it is recommended to use the <strong>package</strong> resource as often as possible. For more information about specific resources for specific platforms, see the following topics:</p>
<ul class="simple">
<li><a class="reference internal" href="resource_apt_package.html"><em>apt_package</em></a></li>
<li><a class="reference internal" href="resource_chef_gem.html"><em>chef_gem</em></a></li>
<li><a class="reference internal" href="resource_dpkg_package.html"><em>dpkg_package</em></a></li>
<li><a class="reference internal" href="resource_easy_install_package.html"><em>easy_install_package</em></a></li>
<li><a class="reference internal" href="resource_freebsd_package.html"><em>freebsd_package</em></a></li>
<li><a class="reference internal" href="resource_gem_package.html"><em>gem_package</em></a></li>
<li><a class="reference internal" href="resource_ips_package.html"><em>ips_package</em></a></li>
<li><a class="reference internal" href="resource_macports_package.html"><em>macports_package</em></a></li>
<li><a class="reference internal" href="resource_pacman_package.html"><em>pacman_package</em></a></li>
<li><a class="reference internal" href="resource_portage_package.html"><em>portage_package</em></a></li>
<li><a class="reference internal" href="resource_rpm_package.html"><em>rpm_package</em></a></li>
<li><a class="reference internal" href="resource_smartos_package.html"><em>smartos_package</em></a></li>
<li><a class="reference internal" href="resource_solaris_package.html"><em>solaris_package</em></a></li>
<li><a class="reference internal" href="resource_yum.html"><em>yum_package</em></a></li>
</ul>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<p>The syntax for using the <strong>package</strong> resource in a recipe is as follows:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;name&quot;</span> <span class="k">do</span>
  <span class="n">some_attribute</span> <span class="s2">&quot;value&quot;</span> <span class="c1"># see attributes section below</span>
  <span class="o">.</span><span class="n">.</span><span class="o">.</span>
  <span class="n">action</span> <span class="ss">:action</span> <span class="c1"># see actions section below</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">package</span></tt> tells Chef to use one of sixteen different providers during the Chef run, where the provider that is used by Chef depends on the platform of the machine on which the Chef run is taking place</li>
<li><tt class="docutils literal"><span class="pre">&quot;name&quot;</span></tt> is the name of the package</li>
<li><tt class="docutils literal"><span class="pre">attribute</span></tt> is zero (or more) of the attributes that are available for this resource</li>
<li><tt class="docutils literal"><span class="pre">:action</span></tt> is the step that the resource will ask the provider to take during the Chef run</li>
</ul>
</div>
<div class="section" id="gem-package-options">
<h2>Gem Package Options<a class="headerlink" href="#gem-package-options" title="Permalink to this headline">¶</a></h2>
<p>The RubyGems package provider attempts to use the RubyGems API to install gems without spawning a new process, whenever possible. A gems command to install will be spawned under the following conditions:</p>
<ul class="simple">
<li>When a <tt class="docutils literal"><span class="pre">gem_binary</span></tt> attribute is specified (as a hash, a string, or by a .gemrc file), the provider will run that command to examine its environment settings and then again to install the gem.</li>
<li>When install options are specified as a string, the provider will span a gems command with those options when installing the gem.</li>
<li>The omnibus installer will search the PATH for a gem command rather than defaulting to the current gem environment. As part of <tt class="docutils literal"><span class="pre">enforce_path_sanity</span></tt>, the <tt class="docutils literal"><span class="pre">bin</span></tt> directories area added to the PATH, which means when there are no other proceeding RubyGems, the installation will still be operated against it.</li>
</ul>
<div class="section" id="specify-with-hash">
<h3>Specify with Hash<a class="headerlink" href="#specify-with-hash" title="Permalink to this headline">¶</a></h3>
<p>If an explicit <tt class="docutils literal"><span class="pre">gem_binary</span></tt> parameter is not being used with the <tt class="docutils literal"><span class="pre">gem_package</span></tt> resource, it is preferable to provide the install options as a hash. This approach allows the provider to install the gem without needing to spawn an external gem process.</p>
<p>The following RubyGems options are available for inclusion within a hash and are passed to the RubyGems DependencyInstaller:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">:env_shebang</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:force</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:format_executable</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:ignore_dependencies</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:prerelease</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:security_policy</span></tt></li>
<li><tt class="docutils literal"><span class="pre">:wrappers</span></tt></li>
</ul>
<p>For more information about these options, see the RubyGems documentation: <a class="reference external" href="http://rubygems.rubyforge.org/rubygems-update/Gem/DependencyInstaller.html">http://rubygems.rubyforge.org/rubygems-update/Gem/DependencyInstaller.html</a>.</p>
<p><strong>Example</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gem_package</span> <span class="s2">&quot;bundler&quot;</span> <span class="k">do</span>
  <span class="n">options</span><span class="p">(</span><span class="ss">:prerelease</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">:format_executable</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="specify-with-string">
<h3>Specify with String<a class="headerlink" href="#specify-with-string" title="Permalink to this headline">¶</a></h3>
<p>When using an explicit <tt class="docutils literal"><span class="pre">gem_binary</span></tt>, options must be passed as a string. When not using an explicit <tt class="docutils literal"><span class="pre">gem_binary</span></tt>, Chef is forced to spawn a gems process to install the gems (which uses more system resources) when options are passed as a string. String options are passed verbatim to the gems command and should be specified just as if they were passed on a command line. For example, <tt class="docutils literal"><span class="pre">--prerelease</span></tt> for a pre-release gem.</p>
<p><strong>Example</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gem_package</span> <span class="s2">&quot;nokogiri&quot;</span> <span class="k">do</span>
  <span class="n">gem_binary</span><span class="p">(</span><span class="s2">&quot;/opt/ree/bin/gem&quot;</span><span class="p">)</span>
  <span class="n">options</span><span class="p">(</span><span class="s2">&quot;--prerelease --no-format-executable&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="section" id="specify-with-gemrc-file">
<h3>Specify with .gemrc File<a class="headerlink" href="#specify-with-gemrc-file" title="Permalink to this headline">¶</a></h3>
<p>Options can be specified in a .gemrc file. By default the <tt class="docutils literal"><span class="pre">gem_package</span></tt> resource will use the Ruby interface to install gems which will ignore the .gemrc file. The <tt class="docutils literal"><span class="pre">gem_package</span></tt> resource can be forced to use the gems command instead (and to read the .gemrc file) by adding the <tt class="docutils literal"><span class="pre">gem_binary</span></tt> attribute to a code block.</p>
<p><strong>Example</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gem_package</span> <span class="s2">&quot;nokogiri&quot;</span> <span class="k">do</span>
  <span class="n">gem_binary</span> <span class="s2">&quot;gem&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="actions">
<h2>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h2>
<p>This resource has the following actions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Action</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:install</span></tt></td>
<td>Default. Use to install a package. If a version is specified, use to install the specified version of a package.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:upgrade</span></tt></td>
<td>Use to upgrade a package to the latest version.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:reconfig</span></tt></td>
<td>Use to reconfigure a package. This action requires a response file.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:remove</span></tt></td>
<td>Use to remove a package.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">:purge</span></tt></td>
<td>Use to purge a package. This action typically removes the configuration files as well as the package. (Debian platform only; for other platforms, use the <tt class="docutils literal"><span class="pre">:remove</span></tt> action.)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h2>
<p>This resource has the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">allow_downgrade</span></tt></td>
<td>Indicates that yum can downgrade a package to satisfy requested version requirements. Default value: <tt class="docutils literal"><span class="pre">false</span></tt>. This attribute is only available for the <tt class="docutils literal"><span class="pre">yum_package</span></tt> resource.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">arch</span></tt></td>
<td>The architecture of the package that will be installed or upgraded. (This value can also be passed as part of the package name.) Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>. This attribute is only available for the <strong>yum_package</strong> resource.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">flush_cache</span></tt></td>
<td>An attribute for the <tt class="docutils literal"><span class="pre">yum_package</span></tt> provider that is used to flush the internal YumCache before or after an install or upgrade action. Default value: <tt class="docutils literal"><span class="pre">{</span> <span class="pre">:before</span> <span class="pre">=&gt;</span> <span class="pre">false,</span> <span class="pre">:after</span> <span class="pre">=&gt;</span> <span class="pre">false</span> <span class="pre">}</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">gem_binary</span></tt></td>
<td>An attribute for the <tt class="docutils literal"><span class="pre">gem_package</span></tt> provider that is used to specify a gems binary. This attribute is useful when installing Ruby 1.9 gems while running Chef in Ruby 1.8.  Default value: <tt class="docutils literal"><span class="pre">nil</span> <span class="pre">(API)</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">options</span></tt></td>
<td>One (or more) additional options that are passed to the command. Can be used with APT, dpkg, Gentoo, RPM Package Manager, and RubyGems. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">package_name</span></tt></td>
<td>The name of the package.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">provider</span></tt></td>
<td>Optional. Use to specify a provider by using its long name. For example: <tt class="docutils literal"><span class="pre">provider</span> <span class="pre">Chef::Provider::Long::Name</span></tt>. See the Providers section below for the list of providers available to this resource.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">response_file</span></tt></td>
<td>Optional. The response file that is used to pre-seed packages. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">source</span></tt></td>
<td>Optional. The package source for providers that use a local file (such as RubyGems, dpkg, yum or RPM Package Manager).</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">version</span></tt></td>
<td>The version of a package to be installed or upgraded. Default value: <tt class="docutils literal"><span class="pre">nil</span></tt>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="providers">
<h2>Providers<a class="headerlink" href="#providers" title="Permalink to this headline">¶</a></h2>
<p>The following providers are available. Use the short name to call the provider from a recipe:</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="15%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Long name</th>
<th class="head">Short name</th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package</span></tt></td>
<td><tt class="docutils literal"><span class="pre">package</span></tt></td>
<td>When this short name is used, Chef will attempt to determine the correct provider during the Chef run.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Apt</span></tt></td>
<td><tt class="docutils literal"><span class="pre">apt_package</span></tt></td>
<td>The <strong>apt_package</strong> resource is used to manage packages for the Debian and Ubuntu platforms.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Dpkg</span></tt></td>
<td><tt class="docutils literal"><span class="pre">dpkg_package</span></tt></td>
<td>The <strong>dpkg_package</strong> resource is used to manage packages for the dpkg platform. When a package is installed from a local file, it must be added to the node using the <strong>remote_file</strong> or <strong>cookbook_file</strong> resources. Can be used with the <tt class="docutils literal"><span class="pre">options</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::EasyInstall</span></tt></td>
<td><tt class="docutils literal"><span class="pre">easy_install_package</span></tt></td>
<td>The <strong>easy_install_package</strong> resource is used to manage packages for the Python platform.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Freebsd</span></tt></td>
<td><tt class="docutils literal"><span class="pre">freebsd_package</span></tt></td>
<td>The <strong>freebsd_package</strong> resource is used to manage packages for the FreeBSD platform.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Ips</span></tt></td>
<td><tt class="docutils literal"><span class="pre">ips_package</span></tt></td>
<td>The <strong>ips_package</strong> resource is used to manage packages for the ips platform.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Macports</span></tt></td>
<td><tt class="docutils literal"><span class="pre">macports_package</span></tt></td>
<td>The <strong>macports_package</strong> resource is used to manage packages for the Mac OS X platform.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Pacman</span></tt></td>
<td><tt class="docutils literal"><span class="pre">pacman_package</span></tt></td>
<td>The <strong>pacman_package</strong> resource is used to manage packages for the pacman platform.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Portage</span></tt></td>
<td><tt class="docutils literal"><span class="pre">portage_package</span></tt></td>
<td>The <strong>portage_package</strong> resource is used to manage packages for the Gentoo platform. Can be used with the <tt class="docutils literal"><span class="pre">options</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Rpm</span></tt></td>
<td><tt class="docutils literal"><span class="pre">rpm_package</span></tt></td>
<td>The <strong>rpm_package</strong> resource is used to manage packages for the RPM Package Manager platform. Can be used with the <tt class="docutils literal"><span class="pre">options</span></tt> attribute.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Rubygems</span></tt></td>
<td><tt class="docutils literal"><span class="pre">gem_package</span></tt></td>
<td>The <strong>gem_package</strong> resource is used to manage gem packages that are only included in recipes. When a package is installed from a local file, it must be added to the node using the <strong>remote_file</strong> or <strong>cookbook_file</strong> resources. Can be used with the <tt class="docutils literal"><span class="pre">options</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Rubygems</span></tt></td>
<td><tt class="docutils literal"><span class="pre">chef_gem</span></tt></td>
<td>The <strong>chef_gem</strong> resource is used to install a gem only for Chef resources. When a package is installed from a local file, it must be added to the node using the <strong>remote_file</strong> or <strong>cookbook_file</strong> resources. Can be used with the <tt class="docutils literal"><span class="pre">options</span></tt> attribute.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Smartos</span></tt></td>
<td><tt class="docutils literal"><span class="pre">smartos_package</span></tt></td>
<td>The <strong>smartos_package</strong> resource is used to manage packages for the SmartOS platform.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Solaris</span></tt></td>
<td><tt class="docutils literal"><span class="pre">solaris_package</span></tt></td>
<td>The <strong>solaris_package</strong> resource is used to manage packages for the Oracle Solaris platform.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Yum</span></tt></td>
<td><tt class="docutils literal"><span class="pre">yum_package</span></tt></td>
<td>The <strong>yum_package</strong> resource is used install, upgrade, and remove packages with yum for the Red Hat and CentOS platforms. The <strong>yum_package</strong> resource is able to resolve <tt class="docutils literal"><span class="pre">provides</span></tt> data for packages much like yum can do when it is run from the command line. This allows a variety of options for installing packages, like minimum versions, virtual provides, and library names.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">Chef::Provider::Package::Zypper</span></tt></td>
<td><tt class="docutils literal"><span class="pre">package</span></tt></td>
<td>The provider that is used with the SuSE platform.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>The following examples demonstrate various approaches for using resources in recipes. If you want to see examples of how Opscode uses resources in recipes, take a closer look at the cookbooks that Opscode authors and maintains: <a class="reference external" href="https://github.com/opscode-cookbooks">https://github.com/opscode-cookbooks</a>.</p>
<p><strong>Install a gems file for use in recipes</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">chef_gem</span> <span class="s2">&quot;right_aws&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>

<span class="nb">require</span> <span class="s1">&#39;right_aws&#39;</span>
</pre></div>
</div>
<p><strong>Install a gems file from the local file system</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gem_package</span> <span class="s2">&quot;right_aws&quot;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">&quot;/tmp/right_aws-1.11.0.gem&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Install a package</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Install a package version</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">version</span> <span class="s2">&quot;1.16.1-1&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Install a package with options</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;debian-archive-keyring&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
  <span class="n">options</span> <span class="s2">&quot;--force-yes&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Install a package with a response_file</strong></p>
<p>Use of a <tt class="docutils literal"><span class="pre">response_file</span></tt> is only supported on Debian and Ubuntu at this time. Providers need to be written to support the use of a <tt class="docutils literal"><span class="pre">response_file</span></tt>, which contains debconf answers to questions normally asked by the package manager on installation. Put the file in files/default of the cookbook where the package is specified and Chef will use the <strong>cookbook_file</strong> resource to retrieve it.</p>
<p>To install a package with a <tt class="docutils literal"><span class="pre">response_file</span></tt>:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;sun-java6-jdk&quot;</span> <span class="k">do</span>
  <span class="n">response_file</span> <span class="s2">&quot;java.seed&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Install a package using a specific provider</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
  <span class="n">source</span> <span class="s2">&quot;/tmp/tar-1.16.1-1.rpm&quot;</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Package</span><span class="o">::</span><span class="no">Rpm</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Install a specified architecture using a named provider</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">yum_package</span> <span class="s2">&quot;glibc-devel&quot;</span> <span class="k">do</span>
  <span class="n">arch</span> <span class="s2">&quot;i386&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Purge a package</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:purge</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Remove a package</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:remove</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Upgrade a package</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;tar&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:upgrade</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Use the ignore_failure common attribute</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">gem_package</span> <span class="s2">&quot;syntax&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
  <span class="n">ignore_failure</span> <span class="kp">true</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Use the provider common attribute</strong></p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;some_package&quot;</span> <span class="k">do</span>
  <span class="n">provider</span> <span class="no">Chef</span><span class="o">::</span><span class="no">Provider</span><span class="o">::</span><span class="no">Package</span><span class="o">::</span><span class="no">Rubygems</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Avoid unnecessary string interpolation</strong></p>
<p>Do this:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;mysql-server&quot;</span> <span class="k">do</span>
  <span class="n">version</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;mysql&#39;</span><span class="o">][</span><span class="s1">&#39;version&#39;</span><span class="o">]</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>and not this:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;mysql-server&quot;</span> <span class="k">do</span>
  <span class="n">version</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">&#39;mysql&#39;</span><span class="o">][</span><span class="s1">&#39;version&#39;</span><span class="o">]</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Install a package in a platform</strong></p>
<p>The following example shows how to use the <strong>package</strong> resource to install an application named &#8220;app&#8221; and ensure that the correct packages are installed for the correct platform:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;app_name&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>

<span class="k">case</span> <span class="n">node</span><span class="o">[</span><span class="ss">:platform</span><span class="o">]</span>
<span class="k">when</span> <span class="s2">&quot;ubuntu&quot;</span><span class="p">,</span><span class="s2">&quot;debian&quot;</span>
  <span class="n">package</span> <span class="s2">&quot;app_name-doc&quot;</span> <span class="k">do</span>
    <span class="n">action</span> <span class="ss">:install</span>
  <span class="k">end</span>
<span class="k">when</span> <span class="s2">&quot;centos&quot;</span>
  <span class="n">package</span> <span class="s2">&quot;app_name-html&quot;</span> <span class="k">do</span>
    <span class="n">action</span> <span class="ss">:install</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Install sudo, then configure /etc/sudoers/ file</strong></p>
<p>The following example shows how to install Indicates that a bootstrap operation should be executed using sudo. and then configure the <tt class="docutils literal"><span class="pre">/etc/sudoers</span></tt> file:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s1">&#39;sudo&#39;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>

<span class="k">if</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;authorization&#39;</span><span class="o">][</span><span class="s1">&#39;sudo&#39;</span><span class="o">][</span><span class="s1">&#39;include_sudoers_d&#39;</span><span class="o">]</span>
  <span class="n">directory</span> <span class="s1">&#39;/etc/sudoers.d&#39;</span> <span class="k">do</span>
    <span class="n">mode</span>        <span class="s1">&#39;0755&#39;</span>
    <span class="n">owner</span>       <span class="s1">&#39;root&#39;</span>
    <span class="n">group</span>       <span class="s1">&#39;root&#39;</span>
    <span class="n">action</span>      <span class="ss">:create</span>
  <span class="k">end</span>

  <span class="n">cookbook_file</span> <span class="s1">&#39;/etc/sudoers.d/README&#39;</span> <span class="k">do</span>
    <span class="n">source</span>      <span class="s1">&#39;README&#39;</span>
    <span class="n">mode</span>        <span class="s1">&#39;0440&#39;</span>
    <span class="n">owner</span>       <span class="s1">&#39;root&#39;</span>
    <span class="n">group</span>       <span class="s1">&#39;root&#39;</span>
    <span class="n">action</span>      <span class="ss">:create</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">template</span> <span class="s1">&#39;/etc/sudoers&#39;</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s1">&#39;sudoers.erb&#39;</span>
  <span class="n">mode</span> <span class="s1">&#39;0440&#39;</span>
  <span class="n">owner</span> <span class="s1">&#39;root&#39;</span>
  <span class="n">group</span> <span class="n">platform?</span><span class="p">(</span><span class="s1">&#39;freebsd&#39;</span><span class="p">)</span> <span class="p">?</span> <span class="s1">&#39;wheel&#39;</span> <span class="p">:</span> <span class="s1">&#39;root&#39;</span>
  <span class="n">variables</span><span class="p">(</span>
    <span class="ss">:sudoers_groups</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;authorization&#39;</span><span class="o">][</span><span class="s1">&#39;sudo&#39;</span><span class="o">][</span><span class="s1">&#39;groups&#39;</span><span class="o">]</span><span class="p">,</span>
    <span class="ss">:sudoers_users</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;authorization&#39;</span><span class="o">][</span><span class="s1">&#39;sudo&#39;</span><span class="o">][</span><span class="s1">&#39;users&#39;</span><span class="o">]</span><span class="p">,</span>
    <span class="ss">:passwordless</span> <span class="o">=&gt;</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;authorization&#39;</span><span class="o">][</span><span class="s1">&#39;sudo&#39;</span><span class="o">][</span><span class="s1">&#39;passwordless&#39;</span><span class="o">]</span>
  <span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li>the <tt class="docutils literal"><span class="pre">package</span></tt> block is used to install Indicates that a bootstrap operation should be executed using sudo.</li>
<li>the <tt class="docutils literal"><span class="pre">if</span></tt> statement is used to ensure availability of the <tt class="docutils literal"><span class="pre">/etc/sudoers.d</span></tt> directory</li>
<li>the <tt class="docutils literal"><span class="pre">template</span></tt> block tells Chef where to find the <tt class="docutils literal"><span class="pre">sudoers</span></tt> template</li>
<li>the <tt class="docutils literal"><span class="pre">variables</span></tt> attribute is a hash that passes values to template files (that are located in the <tt class="docutils literal"><span class="pre">templates/</span></tt> directory for the cookbook</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This example comes from the <tt class="docutils literal"><span class="pre">default</span></tt> recipe in the following cookbook: <a class="reference external" href="https://github.com/opscode-cookbooks/sudo">https://github.com/opscode-cookbooks/sudo</a>.</p>
</div>
<p><strong>Use a case statement to specify the platform</strong></p>
<p>The following example shows how to use a case statement to tell Chef for which platforms and packages should be installed using cURL.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;curl&quot;</span>
  <span class="k">case</span> <span class="n">node</span><span class="o">[</span><span class="ss">:platform</span><span class="o">]</span>
  <span class="k">when</span> <span class="s2">&quot;redhat&quot;</span><span class="p">,</span> <span class="s2">&quot;centos&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;package_1&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;package_2&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;package_3&quot;</span>
  <span class="k">when</span> <span class="s2">&quot;ubuntu&quot;</span><span class="p">,</span> <span class="s2">&quot;debian&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;package_a&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;package_b&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;package_c&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">node[:platform]</span></tt> for each node is identified by Ohai during every Chef run. For example:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;curl&quot;</span>
  <span class="k">case</span> <span class="n">node</span><span class="o">[</span><span class="ss">:platform</span><span class="o">]</span>
  <span class="k">when</span> <span class="s2">&quot;redhat&quot;</span><span class="p">,</span> <span class="s2">&quot;centos&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;zlib-devel&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;openssl-devel&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;libc6-dev&quot;</span>
  <span class="k">when</span> <span class="s2">&quot;ubuntu&quot;</span><span class="p">,</span> <span class="s2">&quot;debian&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;openssl&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;pkg-config&quot;</span>
    <span class="n">package</span> <span class="s2">&quot;subversion&quot;</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Use symbols to reference attributes</strong></p>
<p>Do this:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;mysql-server&quot;</span> <span class="k">do</span>
  <span class="n">version</span> <span class="n">node</span><span class="o">[</span><span class="s1">&#39;mysql&#39;</span><span class="o">][</span><span class="s1">&#39;version&#39;</span><span class="o">]</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p>and not this:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;mysql-server&quot;</span> <span class="k">do</span>
  <span class="n">version</span> <span class="n">node</span><span class="o">[</span><span class="ss">:mysql</span><span class="o">][</span><span class="ss">:version</span><span class="o">]</span>
  <span class="n">action</span> <span class="ss">:install</span>
<span class="k">end</span>
</pre></div>
</div>
<p><strong>Use a whitespace array to simplify a recipe</strong></p>
<p>The following examples show two ways of doing the same thing. The first shows a series of packages that will be upgraded:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">package</span> <span class="s2">&quot;package-a&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:upgrade</span>
<span class="k">end</span>

<span class="n">package</span> <span class="s2">&quot;package-b&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:upgrade</span>
<span class="k">end</span>

<span class="n">package</span> <span class="s2">&quot;package-b&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:upgrade</span>
<span class="k">end</span>

<span class="n">package</span> <span class="s2">&quot;package-b&quot;</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:upgrade</span>
<span class="k">end</span>
</pre></div>
</div>
<p>and the next shows how to do the same exact thing, but with a single <tt class="docutils literal"><span class="pre">package</span></tt> block and a whitespace array (<tt class="docutils literal"><span class="pre">%w</span></tt>):</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="sx">%w{package-a package-b package-c package-d}</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">pkg</span><span class="o">|</span>
  <span class="n">package</span> <span class="n">pkg</span> <span class="k">do</span>
    <span class="n">action</span> <span class="ss">:upgrade</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">|pkg|</span></tt> is used to define the name of the resource, but also to ensure that each item in the whitespace array has its own name.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="resource_pacman_package.html" title="pacman_package"
             >next</a></li>
        <li class="right" >
          <a href="resource_ohai.html" title="ohai"
             >previous</a> |</li>
        <li><a href="http://docs.opscode.com/chef/knife.html" target="_products">Knife</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/resources.html" target="_products">Resources</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/dsl_recipe.html" target="_products">Recipe DSL</a>&#149;</li>
        <li><a href="http://docs.opscode.com/chef/lwrps_custom.html" target="_products">LWRPs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/search.html">Search the Docs</a>&#149;</li>
        <li><a href="http://docs.opscode.com/">Home</a> &raquo;</li>

          <li><a href="resource.html" >About Resources and Providers</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
    This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>


    <div class="footer">
        &copy; Copyright This work is licensed under a Creative Commons Attribution 3.0 Unported License.
    </div>

<!-- Start of Async Google Analytics Code -->
<script type="text/javascript">
var _gaq = _gaq || [];
var pluginUrl = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.') + 'google-analytics.com/plugins/ga/inpage_linkid.js';
_gaq.push(['_setAccount', 'UA-6369228-7']);
_gaq.push(['_setDomainName', '.opscode.com']);
_gaq.push(['_setAllowHash', false]);
_gaq.push(['_setAllowLinker', true]);
_gaq.push(['_addIgnoredRef','opscode.com']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript';
  ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(ga, s); })();
</script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Async HubSpot Analytics Code -->
<script type="text/javascript">
(function(d,s,i,r) {
            if (d.getElementById(i)){return;}
            var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
            n.id=i;n.src='//js.hubspot.com/analytics/'+(Math.ceil(new Date()/r)*r)+'/57718.js';
            e.parentNode.insertBefore(n, e);
        })(document,"script","hs-analytics",300000);
    </script>
<!-- End of Async HubSpot Analytics Code -->

<!-- Start of Contact Analytics Code -->
<script type="text/javascript">
(function() {
  var didInit = false;
  function initMunchkin() {
    if(didInit === false) {
      didInit = true;
      Munchkin.init('255-VFB-268');
    }
  }
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
  s.onreadystatechange = function() {
    if (this.readyState == 'complete' || this.readyState == 'loaded') {
      initMunchkin();
    }
  };
  s.onload = initMunchkin;
  document.getElementsByTagName('head')[0].appendChild(s);
})();
</script>
<!-- End of Contact Analytics Code -->


  </body>
</html>